(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3955],{95667:function(e,t,a){Promise.resolve().then(a.bind(a,54578))},54578:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var n=a(57437),r=a(2265),s=a(31313),l=a(52182),i=a(89733),o=a(38087),c=a(62373),d=a(94729),u=a(11541),f=a(8527),m=a(32431),x=a(19847),p=a(61557),h=a(88411),g=a(27629),v=a(31570),b=a(18259),j=a(71873),N=a(24917),w=a(3424),y=a(25648),z=a(90952),C=a(29973),k=a(4306),D=a(86763),S=a(49354),R=a(77209),T=a(70402),Z=a(99376),M=a(56634),F=a(80023),L=a(54662),$=a(10788);let A="folder-reports";function E(){let[e,t]=(0,r.useState)([]),[a,E]=(0,r.useState)(!0),[I,_]=(0,r.useState)(null),[H,P]=(0,r.useState)(null),[O,U]=(0,r.useState)(!1),[q,V]=(0,r.useState)(""),B=(0,r.useRef)(null),G=(0,r.useRef)(null),{toast:K}=(0,D.pm)(),[W,Y]=(0,r.useState)("");(0,r.useEffect)(()=>{(async function(){E(!0);try{let e=await (0,$.getFiles)();t(e)}catch(e){console.error("Failed to load templates:",e),K({variant:"destructive",title:"Failed to load templates",description:e.message||"Could not retrieve templates from the database."})}finally{E(!1)}})()},[K]),(0,r.useEffect)(()=>{I?P(e.find(e=>e.id===I)||null):P(null)},[I,e]),(0,r.useEffect)(()=>{B.current&&(B.current.innerHTML=(null==H?void 0:H.content)||"")},[H]);let J=e.filter(e=>e.folderId===A),{isListening:Q,startListening:X,stopListening:ee,isSupported:et}=(0,k.I)({onTranscript:e=>{let t=W?"".concat(W," ").concat(e):e;if(B.current){B.current.innerHTML=t,P(e=>e?{...e,content:t}:null);let e=document.createRange(),a=window.getSelection();a&&(e.selectNodeContents(B.current),e.collapse(!1),a.removeAllRanges(),a.addRange(e))}}}),ea=async()=>{if(!q.trim()){K({variant:"destructive",title:"Template name is required."});return}let e={name:q.trim(),folderId:A,type:Z.aG,content:"",size:0,modifiedAt:new Date};try{let a=await (0,$.N2)(e);t(e=>[...e,a]),_(a.id),U(!1),V(""),K({title:"Template Created",description:'"'.concat(a.name,'" is ready for editing.')})}catch(e){console.error("Failed to create template:",e),K({variant:"destructive",title:"Create Failed",description:e.message})}},en=async()=>{var e;if(!H||!(null===(e=H.name)||void 0===e?void 0:e.trim())||!H.id){K({variant:"destructive",title:"Cannot save template.",description:"The template must have a name and ID."});return}let a={name:H.name.trim(),content:H.content||"",size:(H.content||"").length,modifiedAt:new Date};try{await (0,$.Dd)(H.id,a),t(e=>e.map(e=>e.id===H.id?{...e,...a,modifiedAt:a.modifiedAt}:e)),K({title:"Template Saved!",description:'Changes to "'.concat(a.name,'" have been saved.')})}catch(e){console.error("Failed to save template:",e),K({variant:"destructive",title:"Save Failed",description:e.message})}},er=async()=>{if(!H)return;let a=e.find(e=>e.id===H.id);if(!a)return;let n={...a,name:"".concat(a.name," (Copy)"),modifiedAt:new Date};delete n.id;try{let e=await (0,$.N2)(n);t(t=>[...t,e]),_(e.id),K({title:"Template Copied"})}catch(e){console.error("Failed to copy template:",e),K({variant:"destructive",title:"Copy Failed",description:e.message})}},es=async()=>{if(!H||!H.id)return;let a=H.id,n=e.find(e=>e.id===a);if(n&&window.confirm('Are you sure you want to delete "'.concat(n.name,'"?')))try{await (0,$.c1)([a]),t(e=>e.filter(e=>e.id!==a)),I===a&&_(null),K({title:"Template Deleted",variant:"destructive"})}catch(e){console.error("Failed to delete template:",e),K({variant:"destructive",title:"Delete Failed",description:e.message})}},el=(e,t)=>{var a;document.execCommand(e,!1,t),null===(a=B.current)||void 0===a||a.focus()},ei=e=>e.preventDefault();return a?(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center p-4",children:(0,n.jsx)(o.Z,{className:"h-12 w-12 animate-spin text-primary"})}):(0,n.jsxs)("div",{className:"p-4 sm:p-6 flex flex-col h-full space-y-6",children:[(0,n.jsx)(l.ReportsPageHeader,{pageTitle:"Report Templates"}),(0,n.jsxs)("header",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Report Templates"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Create, manage, and utilize standardized report templates."})]}),(0,n.jsxs)(M.ResizablePanelGroup,{direction:"horizontal",className:"flex-1 rounded-lg border",children:[(0,n.jsx)(M.ResizablePanel,{defaultSize:25,minSize:20,maxSize:40,children:(0,n.jsxs)("div",{className:"p-2",children:[(0,n.jsxs)(L.Vq,{open:O,onOpenChange:e=>{U(e),e||V("")},children:[(0,n.jsx)(L.hg,{asChild:!0,children:(0,n.jsxs)(i.z,{className:"w-full mb-2",children:[(0,n.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"New Template"]})}),(0,n.jsxs)(L.cZ,{children:[(0,n.jsxs)(L.fK,{children:[(0,n.jsx)(L.$N,{children:"Create New Template"}),(0,n.jsx)(L.Be,{children:"Please enter a name for your new report template."})]}),(0,n.jsxs)("div",{className:"py-4",children:[(0,n.jsx)(T.Label,{htmlFor:"new-template-name",children:"Template Name"}),(0,n.jsx)(R.I,{id:"new-template-name",value:q,onChange:e=>V(e.target.value),placeholder:"e.g., 'Monthly Client Update'",onKeyDown:e=>{"Enter"===e.key&&ea()}})]}),(0,n.jsxs)(L.cN,{children:[(0,n.jsx)(i.z,{variant:"ghost",onClick:()=>U(!1),children:"Cancel"}),(0,n.jsx)(i.z,{onClick:ea,children:"Create"})]})]})]}),(0,n.jsx)(F.ScrollArea,{className:"h-[calc(100vh-200px)]",children:(0,n.jsx)("div",{className:"space-y-1",children:J.map(e=>(0,n.jsxs)(i.z,{variant:"ghost",className:(0,S.cn)("w-full justify-start text-left h-auto py-2 flex flex-col items-start",I===e.id&&"bg-accent"),onClick:()=>_(e.id),children:[(0,n.jsx)("p",{className:"font-semibold truncate",children:e.name}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,s.WU)(new Date(e.modifiedAt),"MMM d, yyyy")})]},e.id))})})]})}),(0,n.jsx)(M.ResizableHandle,{withHandle:!0}),(0,n.jsx)(M.ResizablePanel,{defaultSize:75,minSize:60,children:H?(0,n.jsxs)("div",{className:"flex-1 flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"p-4 border-b flex flex-wrap items-center justify-between gap-2",children:[(0,n.jsx)(R.I,{ref:G,placeholder:"Untitled Template",value:(null==H?void 0:H.name)||"",onChange:e=>P(t=>t?{...t,name:e.target.value}:null),className:"text-lg font-semibold border-none shadow-none focus-visible:ring-0 p-0 h-auto flex-1 min-w-[200px]"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(i.z,{size:"sm",onClick:en,className:"bg-orange-500 hover:bg-orange-600 text-white",children:[(0,n.jsx)(d.Z,{className:"mr-2 h-4 w-4"})," Save"]}),(0,n.jsxs)(i.z,{size:"sm",disabled:!0,className:"bg-orange-500 hover:bg-orange-600 text-white",children:[(0,n.jsx)(u.Z,{className:"mr-2 h-4 w-4"})," Open"]}),(0,n.jsxs)(i.z,{size:"sm",onClick:()=>{var e;return null===(e=G.current)||void 0===e?void 0:e.focus()},className:"bg-orange-500 hover:bg-orange-600 text-white",children:[(0,n.jsx)(f.Z,{className:"mr-2 h-4 w-4"})," Edit"]}),(0,n.jsxs)(i.z,{size:"sm",onClick:er,className:"bg-orange-500 hover:bg-orange-600 text-white",children:[(0,n.jsx)(m.Z,{className:"mr-2 h-4 w-4"})," Copy"]}),(0,n.jsxs)(i.z,{variant:"destructive",size:"sm",onClick:es,children:[(0,n.jsx)(x.Z,{className:"mr-2 h-4 w-4"})," Delete"]})]})]}),(0,n.jsxs)("div",{className:"p-2 border-b flex items-center gap-1 flex-wrap",children:[(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:"Bold",onMouseDown:ei,onClick:()=>el("bold"),children:(0,n.jsx)(p.Z,{className:"h-4 w-4"})}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:"Italic",onMouseDown:ei,onClick:()=>el("italic"),children:(0,n.jsx)(h.Z,{className:"h-4 w-4"})}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:"Underline",onMouseDown:ei,onClick:()=>el("underline"),children:(0,n.jsx)(g.Z,{className:"h-4 w-4"})}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:"Strikethrough",onMouseDown:ei,onClick:()=>el("strikeThrough"),children:(0,n.jsx)(v.Z,{className:"h-4 w-4"})}),(0,n.jsx)(C.Separator,{orientation:"vertical",className:"h-6 mx-1"}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:"Unordered List",onMouseDown:ei,onClick:()=>el("insertUnorderedList"),children:(0,n.jsx)(b.Z,{className:"h-4 w-4"})}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:"Ordered List",onMouseDown:ei,onClick:()=>el("insertOrderedList"),children:(0,n.jsx)(j.Z,{className:"h-4 w-4"})}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:"Blockquote",onMouseDown:ei,onClick:()=>el("formatBlock","blockquote"),children:(0,n.jsx)(N.Z,{className:"h-4 w-4"})}),(0,n.jsx)(C.Separator,{orientation:"vertical",className:"h-6 mx-1"}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:"Insert Link",onMouseDown:ei,onClick:()=>{let e=prompt("Enter a URL:");e&&el("createLink",e)},children:(0,n.jsx)(w.Z,{className:"h-4 w-4"})}),(0,n.jsx)(C.Separator,{orientation:"vertical",className:"h-6 mx-1"}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",title:Q?"Stop dictation":"Dictate notes",onMouseDown:ei,onClick:()=>{if(Q)ee();else{var e;Y((null==H?void 0:H.content)||""),X(),null===(e=B.current)||void 0===e||e.focus()}},disabled:!1===et,className:(0,S.cn)(Q&&"text-destructive"),children:Q?(0,n.jsx)(y.Z,{className:"h-4 w-4"}):(0,n.jsx)(z.Z,{className:"h-4 w-4"})})]}),(0,n.jsx)(F.ScrollArea,{className:"flex-1",children:(0,n.jsx)("div",{ref:B,className:"prose dark:prose-invert max-w-none p-6 focus:outline-none h-full min-h-[400px]",contentEditable:!0,onInput:e=>{if(!Q){let t=e.currentTarget.innerHTML;P(e=>e?{...e,content:t}:null)}},placeholder:"Start designing your report template here...",dir:"ltr"})})]}):(0,n.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-4 p-4 text-center",children:[(0,n.jsx)(u.Z,{className:"h-16 w-16 text-primary/30",strokeWidth:1.5}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-foreground",children:"Report Template Editor"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Select a template from the list to edit, or create a new one to get started."})]})})]})]})}},54662:function(e,t,a){"use strict";a.d(t,{$N:function(){return h},Be:function(){return g},GG:function(){return u},Vq:function(){return o},cN:function(){return p},cZ:function(){return m},fK:function(){return x},hg:function(){return c}});var n=a(57437),r=a(2265),s=a(13304),l=a(74732),i=a(49354);let o=s.fC,c=s.xz,d=s.h_,u=s.x8,f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});f.displayName=s.aV.displayName;let m=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,n.jsxs)(d,{children:[(0,n.jsx)(f,{}),(0,n.jsxs)(s.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[r,(0,n.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(l.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=s.VY.displayName;let x=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5",t),...a})};x.displayName="DialogHeader";let p=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="DialogFooter";let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});h.displayName=s.Dx.displayName;let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})});g.displayName=s.dk.displayName},77209:function(e,t,a){"use strict";a.d(t,{I:function(){return l}});var n=a(57437),r=a(2265),s=a(49354);let l=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,n.jsx)("input",{type:r,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},70402:function(e,t,a){"use strict";a.d(t,{Label:function(){return c}});var n=a(57437),r=a(2265),s=a(38364),l=a(13027),i=a(49354);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.f,{ref:t,className:(0,i.cn)(o(),a),...r})});c.displayName=s.f.displayName},56634:function(e,t,a){"use strict";a.d(t,{ResizableHandle:function(){return c},ResizablePanel:function(){return o},ResizablePanelGroup:function(){return i}});var n=a(57437),r=a(41505),s=a(65876),l=a(49354);let i=e=>{let{className:t,...a}=e;return(0,n.jsx)(r.eh,{className:(0,l.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})},o=r.s_,c=e=>{let{withHandle:t,className:a,...i}=e;return(0,n.jsx)(r.OT,{className:(0,l.cn)("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...i,children:t&&(0,n.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:(0,n.jsx)(s.Z,{className:"h-2.5 w-2.5"})})})}},80023:function(e,t,a){"use strict";a.d(t,{ScrollArea:function(){return i}});var n=a(57437),r=a(2265),s=a(26770),l=a(49354);let i=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,n.jsxs)(s.fC,{ref:t,className:(0,l.cn)("relative overflow-hidden",a),...i,children:[(0,n.jsx)(s.l_,{className:"h-full w-full rounded-[inherit]",children:r}),(0,n.jsx)(o,{}),(0,n.jsx)(s.Ns,{})]})});i.displayName=s.fC.displayName;let o=r.forwardRef((e,t)=>{let{className:a,orientation:r="vertical",...i}=e;return(0,n.jsx)(s.gb,{ref:t,orientation:r,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,n.jsx)(s.q4,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=s.gb.displayName},10788:function(e,t,a){"use strict";a.d(t,{Dd:function(){return u},LK:function(){return x},N2:function(){return d},Tb:function(){return i},c1:function(){return f},gN:function(){return m},iJ:function(){return c},oN:function(){return l},pT:function(){return r},s6:function(){return o},xh:function(){return s}}),a(74590);var n=a(58064),r=(0,n.$)("74670189be34c225aadd4daa3b2c2b9b771f896d"),s=(0,n.$)("c0aafee0ab43078b94937d0ae184f8df5b5a75d6"),l=(0,n.$)("7046b16c1dca8b64064cd9caf495def3b237133d"),i=(0,n.$)("ff056b5026d2573701069d7974032e6e145a55b4"),o=(0,n.$)("528eb962991f10607df37bbaed22cd255915c0c5"),c=(0,n.$)("6292276674a440923a3f0a8d7056c842e1dce2b4"),d=(0,n.$)("5257ba681075f325b518c6620e75b281db364891"),u=(0,n.$)("3a0a8cdac7ea33faf978949a71d7843895204701"),f=(0,n.$)("cb6d88d0c9e1b05dfa437380f3d767299c3189f2"),m=(0,n.$)("01fc06bcd59fdf101e093294edb9928cbc32ca9e"),x=(0,n.$)("490af0b4d493ea9d29518677fdb1bebeca5b97ef")}},function(e){e.O(0,[2641,231,7255,4086,23,1792,1313,2385,4831,2714,2971,7023,1744],function(){return e(e.s=95667)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5304],{44988:function(e,t,s){Promise.resolve().then(s.bind(s,10912)),Promise.resolve().then(s.bind(s,61481)),Promise.resolve().then(s.bind(s,84111))},84111:function(e,t,s){"use strict";s.r(t),s.d(t,{ProjectPlanningView:function(){return Z}});var a=s(57437),r=s(2265),l=s(87138),n=s(16463),i=s(48185),c=s(89733),d=s(77209),o=s(70402),u=s(4919),m=s(38087),x=s(86644),h=s(85915),p=s(62373),f=s(19847),j=s(19779),v=s(86763),N=s(50215),g=s(36473),b=s(31313),y=s(49354),w=s(21413),C=s(69081),S=s(2128),P=s(44541);let k=e=>{e<0&&(e=0);let t=Math.floor(e/60),s=e%60,a=t>0?"".concat(t," hour").concat(t>1?"s":""):"",r=s>0?"".concat(s," minute").concat(s>1?"s":""):"";return a&&r?"".concat(a,", ").concat(r):a||r||"0 minutes"};function Z(e){let{projectId:t}=e,[s,Z]=(0,r.useState)(null),[D,R]=(0,r.useState)(!0),[F,T]=(0,r.useState)([]),[z,E]=(0,r.useState)(""),[_,I]=(0,r.useState)(""),[L,M]=(0,r.useState)(1),[A,O]=(0,r.useState)(0),[B,H]=(0,r.useState)(new Date),[U,W]=(0,r.useState)(String(new Date().getHours())),[Y,V]=(0,r.useState)("0"),[Q,q]=(0,r.useState)(!0),{user:J}=(0,j.a)(),{toast:$}=(0,v.pm)(),G=(0,n.useRouter)(),K=(0,r.useCallback)(async()=>{R(!0);try{let e=await (0,N.Rp)(t);e?(Z(e),T(e.steps||[])):($({variant:"destructive",title:"Error",description:"Project not found."}),G.push("/projects"))}catch(e){$({variant:"destructive",title:"Failed to load project",description:e.message})}finally{R(!1)}},[t,G,$]);(0,r.useEffect)(()=>{J&&K()},[J,K]);let X=Array.from({length:24},(e,t)=>{let s=(0,g.t)(new Date,{hours:t});return{value:String(t),label:(0,b.WU)(s,"h a")}}),ee=Array.from({length:12},(e,t)=>{let s=5*t;return{value:String(s),label:":".concat(s.toString().padStart(2,"0"))}}),et=e=>{T(t=>t.filter(t=>t.id!==e))},es=async()=>{if(s&&J)try{await (0,N.fk)(J.uid,s.id,{steps:F}),$({title:"Project Plan Saved",description:"Your project steps and any associated calendar events have been saved."}),G.push("/projects")}catch(e){$({variant:"destructive",title:"Save Failed",description:e.message})}};return D?(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsx)(m.Z,{className:"h-10 w-10 animate-spin text-primary"})}):s?(0,a.jsxs)("div",{className:"p-4 sm:p-6 space-y-6",children:[(0,a.jsxs)("header",{className:"relative text-center",children:[(0,a.jsx)("div",{className:"absolute left-0 top-1/2 -translate-y-1/2",children:(0,a.jsx)(c.z,{asChild:!0,variant:"outline",children:(0,a.jsxs)(l.default,{href:"/projects",children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Back to Projects"]})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Project Planning"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:s.name})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 max-w-6xl mx-auto",children:[(0,a.jsxs)(i.Zb,{className:"lg:col-span-1",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsx)(i.ll,{children:"Add a New Step"}),(0,a.jsx)(i.SZ,{children:"Define the tasks required to complete this project."})]}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"step-title",children:"Step Title"}),(0,a.jsx)(d.I,{id:"step-title",value:z,onChange:e=>E(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"step-desc",children:"Description"}),(0,a.jsx)(u.g,{id:"step-desc",value:_,onChange:e=>I(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{children:"Estimate Duration, Hrs. Min."}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)(o.Label,{htmlFor:"step-hours",className:"text-xs text-muted-foreground",children:"Hours"}),(0,a.jsx)(d.I,{id:"step-hours",type:"number",min:"0",value:L,onChange:e=>M(Number(e.target.value))})]}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)(o.Label,{htmlFor:"step-minutes",className:"text-xs text-muted-foreground",children:"Minutes"}),(0,a.jsx)(d.I,{id:"step-minutes",type:"number",min:"0",max:"59",step:"5",value:A,onChange:e=>O(Number(e.target.value))})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,a.jsx)(P.Checkbox,{id:"connect-to-calendar",checked:Q,onCheckedChange:e=>q(!!e)}),(0,a.jsxs)("div",{className:"grid gap-1.5 leading-none",children:[(0,a.jsx)("label",{htmlFor:"connect-to-calendar",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Add to Calendar"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Schedules this step as a task in the calendar."})]})]}),Q&&(0,a.jsxs)("div",{className:"space-y-2 animate-in fade-in-50 duration-300",children:[(0,a.jsx)(o.Label,{children:"Start Date & Time"}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)(w.J2,{children:[(0,a.jsx)(w.xo,{asChild:!0,children:(0,a.jsxs)(c.z,{variant:"outline",className:(0,y.cn)("w-full justify-start text-left font-normal",!B&&"text-muted-foreground"),children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),B?(0,b.WU)(B,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(w.yk,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(C.f,{mode:"single",selected:B,onSelect:H,initialFocus:!0})})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(S.Ph,{value:U,onValueChange:W,children:[(0,a.jsx)(S.i4,{children:(0,a.jsx)(S.ki,{})}),(0,a.jsx)(S.Bw,{children:X.map(e=>(0,a.jsx)(S.Ql,{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)(S.Ph,{value:Y,onValueChange:V,children:[(0,a.jsx)(S.i4,{children:(0,a.jsx)(S.ki,{})}),(0,a.jsx)(S.Bw,{children:ee.map(e=>(0,a.jsx)(S.Ql,{value:e.value,children:e.label},e.value))})]})]})]}),(0,a.jsxs)(c.z,{onClick:()=>{let e=60*(Number(L)||0)+(Number(A)||0);if(!z.trim()||e<=0){$({variant:"destructive",title:"Missing Information",description:"Please provide a title and a duration greater than 0."});return}let t=null;Q&&B&&(t=(0,g.t)(B,{hours:parseInt(U),minutes:parseInt(Y)}));let s={id:"temp_".concat(Date.now()),title:z,description:_,durationMinutes:e,isBillable:!0,connectToCalendar:Q,startTime:t,isCompleted:!1};T(e=>[...e,s]),E(""),I(""),M(1),O(0)},className:"w-full",children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"})," Add Step to Plan"]})]})]}),(0,a.jsxs)(i.Zb,{className:"lg:col-span-2",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsx)(i.ll,{children:"Project Plan"}),(0,a.jsx)(i.SZ,{children:"Review the steps defined for this project."})]}),(0,a.jsx)(i.aY,{children:F.length>0?(0,a.jsx)("div",{className:"space-y-4",children:F.map((e,t)=>(0,a.jsxs)(i.Zb,{className:"p-4 flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-semibold",children:[t+1,". ",e.title]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Est. Duration: ",k(e.durationMinutes)]}),e.connectToCalendar&&e.startTime&&(0,a.jsxs)("p",{className:"text-xs text-primary mt-1 flex items-center gap-1",children:[(0,a.jsx)(h.Z,{className:"h-3 w-3"}),"Scheduled for ",(0,b.WU)(e.startTime,"PPp")]})]}),(0,a.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>et(e.id),children:(0,a.jsx)(f.Z,{className:"h-4 w-4 text-destructive"})})]},e.id))}):(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-16 border-2 border-dashed rounded-lg",children:[(0,a.jsx)("p",{children:"No steps defined yet."}),(0,a.jsx)("p",{className:"text-sm",children:"Use the form on the left to add the first step."})]})}),F.length>0&&(0,a.jsx)("div",{className:"p-6 pt-0",children:(0,a.jsx)(c.z,{onClick:es,className:"w-full",children:"Save Project Plan"})})]})]})]}):(0,a.jsx)("div",{className:"p-4",children:"Project not found."})}},48185:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return n},aY:function(){return o},eW:function(){return u},ll:function(){return c}});var a=s(57437),r=s(2265),l=s(49354);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},44541:function(e,t,s){"use strict";s.d(t,{Checkbox:function(){return c}});var a=s(57437),r=s(2265),l=s(69324),n=s(60926),i=s(49354);let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.fC,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,a.jsx)(l.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})})});c.displayName=l.fC.displayName}},function(e){e.O(0,[4358,4728,2641,231,7255,4086,5510,9279,3070,1792,1313,2827,4694,9659,2393,2971,7023,1744],function(){return e(e.s=44988)}),_N_E=e.O()}]);
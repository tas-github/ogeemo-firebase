(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7861],{73599:function(e,s,n){Promise.resolve().then(n.bind(n,10912)),Promise.resolve().then(n.bind(n,61481)),Promise.resolve().then(n.bind(n,97753))},97753:function(e,s,n){"use strict";n.r(s),n.d(s,{IncomeView:function(){return D}});var t=n(57437),a=n(2265),i=n(87138),l=n(47304),c=n(48185),r=n(89733),d=n(1104),o=n(80822),m=n(38087),x=n(91241),h=n(69893),p=n(8527),u=n(19847),j=n(47949),g=n(31590),v=n(54662),N=n(29943),y=n(77209),f=n(70402),b=n(2128),C=n(86763),S=n(80112),T=n(19779),w=n(76598);let I={date:"",company:"",description:"",amount:"",incomeType:"",depositedTo:"",explanation:"",documentNumber:"",type:"business"},F=["Service Revenue","Consulting","Sales Revenue","Other Income","Invoice Payment"],k=["Client Alpha","Client Beta","E-commerce Store","Affiliate Payout"],A=["Bank Account #1","Credit Card #1","Cash Account"];function D(){let[e,s]=a.useState([]),[n,D]=a.useState(!0),{user:L}=(0,T.a)(),[Z,E]=a.useState(F),[P,O]=a.useState(k),[_,B]=a.useState(A),[V,z]=a.useState(!1),[R,$]=a.useState(null),[X,Q]=a.useState(null),[U,q]=a.useState(I),[H,K]=a.useState(""),{toast:M}=(0,C.pm)();a.useEffect(()=>{if(!L){D(!1);return}(async()=>{D(!0);try{let e=await (0,w.ky)(L.uid);s(e)}catch(e){M({variant:"destructive",title:"Failed to load income data",description:e.message})}finally{D(!1)}})()},[L,M]);let Y=e=>{e?($(e),q({date:e.date,company:e.company,description:e.description,amount:String(e.amount),incomeType:e.incomeType,depositedTo:e.depositedTo,explanation:e.explanation||"",documentNumber:e.documentNumber||"",type:e.type||"business"})):($(null),q(I)),z(!0)},G=async()=>{if(!L)return;let e=parseFloat(U.amount);if(!U.date||!U.company||!U.incomeType||!U.amount||isNaN(e)||e<=0){M({variant:"destructive",title:"Invalid Input",description:"Please fill all required fields correctly."});return}let n={date:U.date,company:U.company,description:U.description.trim(),amount:e,incomeType:U.incomeType,depositedTo:U.depositedTo,explanation:U.explanation.trim(),documentNumber:U.documentNumber.trim(),type:U.type};try{if(R)await (0,w.FH)(R.id,n),s(e=>e.map(e=>e.id===R.id?{...e,...n}:e)),M({title:"Income Transaction Updated"});else{let e=await (0,w.$K)({...n,userId:L.uid});s(s=>[e,...s]),M({title:"Income Transaction Added"})}z(!1)}catch(e){M({variant:"destructive",title:"Save Failed",description:e.message})}},W=async()=>{if(X)try{await (0,w.HS)(X.id),s(e=>e.filter(e=>e.id!==X.id)),M({title:"Transaction Deleted"})}catch(e){M({variant:"destructive",title:"Delete Failed",description:e.message})}finally{Q(null)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-4 sm:p-6 space-y-6",children:[(0,t.jsx)(j.X,{pageTitle:"Manage Income"}),(0,t.jsxs)("header",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Income"}),(0,t.jsx)("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Review and manage all incoming revenue."})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.ll,{children:"Income Transactions"}),(0,t.jsx)(c.SZ,{children:"A list of all recorded income."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.z,{asChild:!0,variant:"outline",children:(0,t.jsxs)(i.default,{href:"/accounting/transactions/expenses",children:[(0,t.jsx)(d.Z,{className:"mr-2 h-4 w-4"})," Go to Expenses"]})}),(0,t.jsxs)(r.z,{variant:"outline",onClick:()=>Y(),children:[(0,t.jsx)(o.Z,{className:"mr-2 h-4 w-4"})," Add Income"]})]})]}),(0,t.jsx)(c.aY,{children:n?(0,t.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,t.jsx)(m.Z,{className:"h-8 w-8 animate-spin"})}):(0,t.jsxs)(l.iA,{children:[(0,t.jsx)(l.xD,{children:(0,t.jsxs)(l.SC,{children:[(0,t.jsx)(l.ss,{children:"Date"}),(0,t.jsx)(l.ss,{children:"Company"}),(0,t.jsx)(l.ss,{children:"Description"}),(0,t.jsx)(l.ss,{children:"Income Type"}),(0,t.jsx)(l.ss,{className:"text-right",children:"Amount"}),(0,t.jsx)(l.ss,{children:(0,t.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,t.jsx)(l.RM,{children:e.map(e=>(0,t.jsxs)(l.SC,{children:[(0,t.jsx)(l.pj,{children:e.date}),(0,t.jsx)(l.pj,{children:e.company}),(0,t.jsx)(l.pj,{children:e.description}),(0,t.jsx)(l.pj,{children:e.incomeType}),(0,t.jsx)(l.pj,{className:"text-right font-mono text-green-600",children:e.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,t.jsx)(l.pj,{children:(0,t.jsxs)(g.h_,{children:[(0,t.jsx)(g.$F,{asChild:!0,children:(0,t.jsxs)(r.z,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(x.Z,{className:"h-4 w-4"})]})}),(0,t.jsxs)(g.AW,{align:"end",children:[(0,t.jsxs)(g.Xi,{onSelect:()=>Y(e),children:[(0,t.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Open"]}),(0,t.jsxs)(g.Xi,{onSelect:()=>Y(e),children:[(0,t.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,t.jsxs)(g.Xi,{className:"text-destructive",onSelect:()=>Q(e),children:[(0,t.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id))})]})})]})]}),(0,t.jsx)(v.Vq,{open:V,onOpenChange:z,children:(0,t.jsxs)(v.cZ,{children:[(0,t.jsx)(v.fK,{className:"text-center sm:text-center",children:(0,t.jsx)(v.$N,{className:"text-2xl text-primary",children:R?"Edit Income":"Add Income"})}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsxs)(f.Label,{htmlFor:"tx-date",className:"text-right",children:["Date ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsx)(y.I,{id:"tx-date",type:"date",value:U.date,onChange:e=>q(s=>({...s,date:e.target.value})),className:"col-span-3"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsxs)(f.Label,{htmlFor:"tx-company",className:"text-right",children:["Company ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsx)("div",{className:"col-span-3 flex items-center gap-2",children:(0,t.jsxs)(b.Ph,{value:U.company,onValueChange:e=>q(s=>({...s,company:e})),children:[(0,t.jsx)(b.i4,{id:"tx-company",className:"w-full",children:(0,t.jsx)(b.ki,{placeholder:"Select or add a company"})}),(0,t.jsx)(b.Bw,{children:P.map(e=>(0,t.jsx)(b.Ql,{value:e,children:e},e))})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(f.Label,{htmlFor:"tx-doc-number",className:"text-right",children:"Document #"}),(0,t.jsx)(y.I,{id:"tx-doc-number",value:U.documentNumber,onChange:e=>q(s=>({...s,documentNumber:e.target.value})),className:"col-span-3"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(f.Label,{htmlFor:"tx-description",className:"text-right",children:"Description"}),(0,t.jsx)(y.I,{id:"tx-description",value:U.description,onChange:e=>q(s=>({...s,description:e.target.value})),className:"col-span-3"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsxs)(f.Label,{htmlFor:"tx-amount",className:"text-right",children:["Amount ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsxs)("div",{className:"relative col-span-3",children:[(0,t.jsx)("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-muted-foreground",children:"$"}),(0,t.jsx)(y.I,{id:"tx-amount",type:"number",value:U.amount,onChange:e=>q(s=>({...s,amount:e.target.value})),className:"pl-7",step:"0.01",placeholder:"0.00"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(f.Label,{htmlFor:"tx-deposit-account",className:"text-right",children:"Deposited To"}),(0,t.jsx)("div",{className:"col-span-3 flex items-center gap-2",children:(0,t.jsxs)(b.Ph,{value:U.depositedTo,onValueChange:e=>q(s=>({...s,depositedTo:e})),children:[(0,t.jsx)(b.i4,{id:"tx-deposit-account",className:"w-full",children:(0,t.jsx)(b.ki,{placeholder:"Select an account"})}),(0,t.jsx)(b.Bw,{children:_.map(e=>(0,t.jsx)(b.Ql,{value:e,children:e},e))})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsxs)(f.Label,{htmlFor:"tx-income-type",className:"text-right",children:["Income Type ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsx)("div",{className:"col-span-3 flex items-center gap-2",children:(0,t.jsxs)(b.Ph,{value:U.incomeType,onValueChange:e=>q(s=>({...s,incomeType:e})),children:[(0,t.jsx)(b.i4,{id:"tx-income-type",className:"w-full",children:(0,t.jsx)(b.ki,{placeholder:"Select a type"})}),(0,t.jsx)(b.Bw,{children:Z.map(e=>(0,t.jsx)(b.Ql,{value:e,children:e},e))})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(f.Label,{htmlFor:"tx-explanation",className:"text-right",children:"Explanation"}),(0,t.jsx)(y.I,{id:"tx-explanation",value:U.explanation,onChange:e=>q(s=>({...s,explanation:e.target.value})),className:"col-span-3"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(f.Label,{htmlFor:"tx-type",className:"text-right",children:"Type"}),(0,t.jsxs)(S.E,{value:U.type,onValueChange:e=>q(s=>({...s,type:e})),className:"col-span-3 flex items-center space-x-4",id:"tx-type",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(S.m,{value:"business",id:"type-business-inc"}),(0,t.jsx)(f.Label,{htmlFor:"type-business-inc",children:"Business"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(S.m,{value:"personal",id:"type-personal-inc"}),(0,t.jsx)(f.Label,{htmlFor:"type-personal-inc",children:"Personal"})]})]})]})]}),(0,t.jsxs)(v.cN,{children:[(0,t.jsx)(r.z,{variant:"ghost",onClick:()=>z(!1),children:"Cancel"}),(0,t.jsx)(r.z,{onClick:G,children:R?"Save Changes":"Save Income"})]})]})}),(0,t.jsx)(N.aR,{open:!!X,onOpenChange:()=>Q(null),children:(0,t.jsxs)(N._T,{children:[(0,t.jsxs)(N.fY,{children:[(0,t.jsx)(N.f$,{children:"Are you sure?"}),(0,t.jsxs)(N.yT,{children:['This action will permanently delete the transaction: "',null==X?void 0:X.description,'".']})]}),(0,t.jsxs)(N.xo,{children:[(0,t.jsx)(N.le,{children:"Cancel"}),(0,t.jsx)(N.OL,{onClick:W,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})})]})}},1104:function(e,s,n){"use strict";n.d(s,{Z:function(){return t}});let t=(0,n(6497).Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])}},function(e){e.O(0,[4358,4728,2641,231,7255,4086,5510,9279,3070,6680,2827,6669,9249,7322,9554,2971,7023,1744],function(){return e(e.s=73599)}),_N_E=e.O()}]);
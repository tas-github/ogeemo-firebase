(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{95986:function(e,t,a){Promise.resolve().then(a.bind(a,10912)),Promise.resolve().then(a.bind(a,61481)),Promise.resolve().then(a.bind(a,80135))},80135:function(e,t,a){"use strict";a.r(t),a.d(t,{InvoicePaymentsView:function(){return A}});var n=a(57437),r=a(2265),s=a(16463),i=a(48185),l=a(47304),o=a(79055),c=a(89733),d=a(77209),u=a(70402),m=a(54662),f=a(29943),x=a(31590),h=a(38087),g=a(91241),p=a(11541),j=a(83625),N=a(11702),y=a(19847),b=a(21121),v=a(86763),w=a(31313),S=a(19779),P=a(76598);function A(){let[e,t]=(0,r.useState)([]),[a,A]=(0,r.useState)(!0),[C,D]=(0,r.useState)(!1),[R,Z]=(0,r.useState)(null),[k,I]=(0,r.useState)(""),[T,V]=(0,r.useState)(null),{toast:z}=(0,v.pm)(),O=(0,s.useRouter)(),{user:F}=(0,S.a)();(0,r.useEffect)(()=>{!async function(){if(!F){A(!1);return}A(!0);try{let e=await (0,P.sA)(F.uid);t(e.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()))}catch(e){console.error("Failed to load invoice data:",e),z({variant:"destructive",title:"Error",description:"Could not load invoice data."})}finally{A(!1)}}()},[z,F]);let _=(0,r.useMemo)(()=>e.reduce((e,t)=>{let a=t.originalAmount-t.amountPaid;return e+(a>0?a:0)},0),[e]),U=e=>{Z(e);let t=e.originalAmount-e.amountPaid;I(t>0?parseFloat(t.toFixed(2)):""),D(!0)},E=async()=>{if(!R||""===k||0>=Number(k)){z({variant:"destructive",title:"Invalid Amount",description:"Please enter a valid payment amount."});return}try{let e=R.amountPaid+Number(k);await (0,P.e9)(R.id,{amountPaid:e},[]),t(t=>t.map(t=>t.id===R.id?{...t,amountPaid:e}:t)),z({title:"Payment Recorded",description:"Payment of ".concat(Number(k).toLocaleString("en-US",{style:"currency",currency:"USD"})," recorded.")}),D(!1),Z(null),I("")}catch(e){console.error("Failed to record payment:",e),z({variant:"destructive",title:"Error",description:"Could not record payment."})}},H=e=>{try{localStorage.setItem("editInvoiceId",e.id),O.push("/accounting/invoices/create")}catch(e){console.error("Failed to set invoice for editing:",e),z({variant:"destructive",title:"Error",description:"Could not prepare the invoice for editing."})}},L=async()=>{if(T)try{await (0,P.Wu)(T.id),t(e=>e.filter(e=>e.id!==T.id)),z({title:"Invoice Deleted",description:"Invoice ".concat(T.invoiceNumber," has been removed.")})}catch(e){z({variant:"destructive",title:"Delete Failed",description:e.message})}finally{V(null)}},$=t=>{let a=e.filter(e=>e.clientName===t.clientName&&e.id!==t.id).reduce((e,t)=>e+(t.originalAmount-t.amountPaid),0);try{let e={...t,dueDate:t.dueDate.toISOString(),invoiceDate:t.invoiceDate.toISOString(),createdAt:t.createdAt.toISOString()};sessionStorage.setItem("ogeemo-receipt-data",JSON.stringify({invoice:e,carryForwardAmount:a})),O.push("/accounting/invoices/receipt")}catch(e){console.error("Failed to set receipt data:",e),z({variant:"destructive",title:"Error",description:"Could not generate the receipt."})}},B=e=>e.originalAmount-e.amountPaid<=.001?{status:"Paid",badgeVariant:"secondary"}:e.amountPaid>0?{status:"Partially Paid",badgeVariant:"outline"}:new Date(e.dueDate)<new Date?{status:"Overdue",badgeVariant:"destructive"}:{status:"Outstanding",badgeVariant:"outline"};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"p-4 sm:p-6 space-y-6",children:[(0,n.jsx)(b.AccountingPageHeader,{pageTitle:"Accounts Receivable"}),(0,n.jsxs)("header",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Accounts Receivable"}),(0,n.jsx)("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Manage all outstanding invoices and payments due from clients."})]}),(0,n.jsxs)(i.Zb,{children:[(0,n.jsxs)(i.Ol,{className:"flex-row justify-between items-start",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(i.ll,{children:"Outstanding Invoices"}),(0,n.jsx)(i.SZ,{children:"A list of all client invoices from the database."})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Balance Due"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-primary",children:_.toLocaleString("en-US",{style:"currency",currency:"USD"})})]})]}),(0,n.jsx)(i.aY,{children:(0,n.jsx)("div",{className:"border rounded-md",children:(0,n.jsxs)(l.iA,{children:[(0,n.jsx)(l.xD,{children:(0,n.jsxs)(l.SC,{children:[(0,n.jsx)(l.ss,{children:"Invoice #"}),(0,n.jsx)(l.ss,{children:"Client"}),(0,n.jsx)(l.ss,{children:"Due Date"}),(0,n.jsx)(l.ss,{className:"text-right",children:"Original Amount"}),(0,n.jsx)(l.ss,{className:"text-right",children:"Amount Paid"}),(0,n.jsx)(l.ss,{className:"text-right",children:"Balance Due"}),(0,n.jsx)(l.ss,{className:"text-center",children:"Status"}),(0,n.jsx)(l.ss,{className:"text-right",children:"Actions"})]})}),(0,n.jsx)(l.RM,{children:a?(0,n.jsx)(l.SC,{children:(0,n.jsx)(l.pj,{colSpan:8,className:"text-center h-24",children:(0,n.jsx)(h.Z,{className:"mx-auto h-6 w-6 animate-spin"})})}):e.length>0?e.map(e=>{let{status:t,badgeVariant:a}=B(e),r=e.originalAmount-e.amountPaid;return(0,n.jsxs)(l.SC,{children:[(0,n.jsx)(l.pj,{children:e.invoiceNumber}),(0,n.jsx)(l.pj,{children:e.clientName}),(0,n.jsx)(l.pj,{children:(0,w.WU)(new Date(e.dueDate),"PP")}),(0,n.jsx)(l.pj,{className:"text-right font-mono",children:e.originalAmount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,n.jsx)(l.pj,{className:"text-right font-mono text-green-600",children:e.amountPaid.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,n.jsx)(l.pj,{className:"text-right font-mono",children:r.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,n.jsx)(l.pj,{className:"text-center",children:(0,n.jsx)(o.C,{variant:a,className:"secondary"===a?"bg-green-100 text-green-800":"",children:t})}),(0,n.jsx)(l.pj,{className:"text-right",children:(0,n.jsxs)(x.h_,{children:[(0,n.jsx)(x.$F,{asChild:!0,children:(0,n.jsx)(c.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,n.jsx)(g.Z,{className:"h-4 w-4"})})}),(0,n.jsxs)(x.AW,{align:"end",children:[(0,n.jsxs)(x.Xi,{onSelect:()=>$(e),children:[(0,n.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"View / Print Receipt"]}),(0,n.jsxs)(x.Xi,{onSelect:()=>H(e),children:[(0,n.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"Edit Invoice"]}),(0,n.jsxs)(x.Xi,{onSelect:()=>U(e),disabled:"Paid"===t,children:[(0,n.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Post Payment"]}),(0,n.jsxs)(x.Xi,{onSelect:()=>V(e),className:"text-destructive",children:[(0,n.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"Delete Invoice"]})]})]})})]},e.id)}):(0,n.jsx)(l.SC,{children:(0,n.jsx)(l.pj,{colSpan:8,className:"text-center h-24 text-muted-foreground",children:"No invoices found."})})})]})})})]})]}),(0,n.jsx)(m.Vq,{open:C,onOpenChange:D,children:(0,n.jsxs)(m.cZ,{children:[(0,n.jsxs)(m.fK,{children:[(0,n.jsxs)(m.$N,{children:["Post Payment for ",null==R?void 0:R.invoiceNumber]}),(0,n.jsx)(m.Be,{children:"Enter the amount received. This will be added to your income ledger."})]}),(0,n.jsxs)("div",{className:"py-4 space-y-2",children:[(0,n.jsx)(u.Label,{htmlFor:"payment-amount",children:"Payment Amount"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-muted-foreground",children:"$"}),(0,n.jsx)(d.I,{id:"payment-amount",type:"number",placeholder:"0.00",value:k,onChange:e=>I(""===e.target.value?"":Number(e.target.value)),className:"pl-7"})]})]}),(0,n.jsxs)(m.cN,{children:[(0,n.jsx)(c.z,{variant:"ghost",onClick:()=>D(!1),children:"Cancel"}),(0,n.jsx)(c.z,{onClick:E,children:"Post Payment"})]})]})}),(0,n.jsx)(f.aR,{open:!!T,onOpenChange:()=>V(null),children:(0,n.jsxs)(f._T,{children:[(0,n.jsxs)(f.fY,{children:[(0,n.jsx)(f.f$,{children:"Are you sure?"}),(0,n.jsxs)(f.yT,{children:["This will permanently delete invoice ",null==T?void 0:T.invoiceNumber," and all of its data."]})]}),(0,n.jsxs)(f.xo,{children:[(0,n.jsx)(f.le,{children:"Cancel"}),(0,n.jsx)(f.OL,{onClick:L,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})})]})}},21121:function(e,t,a){"use strict";a.d(t,{AccountingPageHeader:function(){return v}});var n=a(57437),r=a(87138),s=a(89733),i=a(31590),l=a(20594),o=a(98630),c=a(3409),d=a(1104),u=a(61990),m=a(29520),f=a(9480),x=a(67755),h=a(99266),g=a(80032),p=a(921),j=a(90186),N=a(74732),y=a(68358);let b=[{href:"/accounting/invoices/payments",icon:l.Z,label:"Accounts Receivable"},{href:"/accounting/invoices/create",icon:o.Z,label:"Invoice Generator"},{href:"/accounting/transactions/income",icon:c.Z,label:"Manage Income"},{href:"/accounting/transactions/expenses",icon:d.Z,label:"Manage Expenses"},{href:"/accounting/ledgers",icon:u.Z,label:"General Ledger"},{href:"/accounting/accounts-payable",icon:m.Z,label:"Accounts Payable"},{href:"/accounting/bank-statements",icon:f.Z,label:"Bank Statements"},{href:"/accounting/reports",icon:x.Z,label:"Reporting Hub"},{href:"/accounting/vitals",icon:h.Z,label:"Financial Vitals"},{href:"/accounting/onboarding",icon:g.Z,label:"Client Onboarding"},{href:"/accounting/bks-info",icon:p.Z,label:"BKS Info"}];function v(e){let{pageTitle:t}=e;return(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(y.aG,{children:(0,n.jsxs)(y.Jb,{children:[(0,n.jsx)(y.gN,{children:(0,n.jsx)(y.At,{asChild:!0,children:(0,n.jsx)(r.default,{href:"/accounting",children:"Accounting Hub"})})}),(0,n.jsx)(y.bg,{}),(0,n.jsx)(y.gN,{children:(0,n.jsx)(y.AG,{children:t})})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(i.h_,{children:[(0,n.jsx)(i.$F,{asChild:!0,children:(0,n.jsxs)(s.z,{variant:"outline",children:["Quick Navigation ",(0,n.jsx)(j.Z,{className:"ml-2 h-4 w-4"})]})}),(0,n.jsx)(i.AW,{align:"end",children:b.map(e=>(0,n.jsx)(i.Xi,{asChild:!0,children:(0,n.jsxs)(r.default,{href:e.href,children:[(0,n.jsx)(e.icon,{className:"mr-2 h-4 w-4"}),e.label]})},e.href))})]}),(0,n.jsx)(s.z,{asChild:!0,variant:"ghost",size:"icon",className:"rounded-full",children:(0,n.jsx)(r.default,{href:"/accounting","aria-label":"Return to Accounting Hub",children:(0,n.jsx)(N.Z,{className:"h-5 w-5"})})})]})]})}},29943:function(e,t,a){"use strict";a.d(t,{OL:function(){return g},_T:function(){return u},aR:function(){return o},f$:function(){return x},fY:function(){return m},le:function(){return p},xo:function(){return f},yT:function(){return h}});var n=a(57437),r=a(2265),s=a(76669),i=a(49354),l=a(89733);let o=s.fC;s.xz;let c=s.h_,d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});d.displayName=s.aV.displayName;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(d,{}),(0,n.jsx)(s.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});u.displayName=s.VY.displayName;let m=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};m.displayName="AlertDialogHeader";let f=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};f.displayName="AlertDialogFooter";let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold",a),...r})});x.displayName=s.Dx.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})});h.displayName=s.dk.displayName;let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.aU,{ref:t,className:(0,i.cn)((0,l.d)(),a),...r})});g.displayName=s.aU.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.$j,{ref:t,className:(0,i.cn)((0,l.d)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});p.displayName=s.$j.displayName},79055:function(e,t,a){"use strict";a.d(t,{C:function(){return l}});var n=a(57437);a(2265);var r=a(13027),s=a(49354);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,...r}=e;return(0,n.jsx)("div",{className:(0,s.cn)(i({variant:a}),t),...r})}},54662:function(e,t,a){"use strict";a.d(t,{$N:function(){return g},Be:function(){return p},GG:function(){return u},Vq:function(){return o},cN:function(){return h},cZ:function(){return f},fK:function(){return x},hg:function(){return c}});var n=a(57437),r=a(2265),s=a(13304),i=a(74732),l=a(49354);let o=s.fC,c=s.xz,d=s.h_,u=s.x8,m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});m.displayName=s.aV.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,n.jsxs)(d,{children:[(0,n.jsx)(m,{}),(0,n.jsxs)(s.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[r,(0,n.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(i.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=s.VY.displayName;let x=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5",t),...a})};x.displayName="DialogHeader";let h=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};h.displayName="DialogFooter";let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});g.displayName=s.Dx.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});p.displayName=s.dk.displayName},47304:function(e,t,a){"use strict";a.d(t,{RM:function(){return o},SC:function(){return d},iA:function(){return i},pj:function(){return m},ss:function(){return u},xD:function(){return l},yt:function(){return c}});var n=a(57437),r=a(2265),s=a(49354);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:t,className:(0,s.cn)("w-full caption-bottom text-sm",a),...r})})});i.displayName="Table";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("thead",{ref:t,className:(0,s.cn)("[&_tr]:border-b",a),...r})});l.displayName="TableHeader";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,s.cn)("[&_tr:last-child]:border-0",a),...r})});o.displayName="TableBody";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})});c.displayName="TableFooter";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("tr",{ref:t,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});d.displayName="TableRow";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("th",{ref:t,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});u.displayName="TableHead";let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("td",{ref:t,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});m.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("caption",{ref:t,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"}},function(e){e.O(0,[4358,4728,2641,231,7255,4086,5510,9279,3070,6680,1792,1313,6669,796,7322,2971,7023,1744],function(){return e(e.s=95986)}),_N_E=e.O()}]);
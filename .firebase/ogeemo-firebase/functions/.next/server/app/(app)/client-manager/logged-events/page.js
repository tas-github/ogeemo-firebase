(()=>{var e={};e.id=8859,e.ids=[8859],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},19021:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(10875),s(25215),s(35866),s(20306);var r=s(23191),i=s(88716),n=s(37922),a=s.n(n),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["(app)",{children:["client-manager",{children:["logged-events",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,10875)),"/home/user/studio/src/app/(app)/client-manager/logged-events/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,25215)),"/home/user/studio/src/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,20306)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/home/user/studio/src/app/(app)/client-manager/logged-events/page.tsx"],u="/(app)/client-manager/logged-events/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(app)/client-manager/logged-events/page",pathname:"/client-manager/logged-events",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},78227:(e,t,s)=>{Promise.resolve().then(s.bind(s,82173))},82173:(e,t,s)=>{"use strict";s.d(t,{LoggedEntriesView:()=>F});var r=s(10326),i=s(17577),n=s(90434),a=s(35047),l=s(51027),o=s(91664),c=s(61486),d=s(33194),u=s(29752),x=s(41156),h=s(44794),m=s(73877),p=s(49708),j=s(9921),g=s(18615),f=s(46721),v=s(70744),y=s(60883),b=s(14289),N=s(64150),w=s(37084),P=s(69559),C=s(31232),q=s(98181),S=s(68136),_=s(84097),D=s(32589),Z=s(65532),L=s(51223),k=s(10143),M=s(55296),R=s(18089);let $=e=>`${Math.floor(e/3600)}h ${Math.floor(e%3600/60)}m`,T=e=>{let t=new Date(e);return t.setHours(23,59,59,999),t};function F(){let[e,t]=(0,i.useState)([]),[s,F]=(0,i.useState)([]),[O,z]=(0,i.useState)(!0),[E,U]=(0,i.useState)(null),[A,W]=(0,i.useState)(void 0),[I,G]=(0,i.useState)(!1),[Y,B]=(0,i.useState)(null),[J,X]=(0,i.useState)(null),{user:H}=(0,S.a)(),{toast:V}=(0,_.pm)(),{handlePrint:Q,contentRef:K}=(0,D.Y)(),ee=(0,a.useRouter)(),et=(0,i.useMemo)(()=>E?s.filter(e=>e.accountId===E).filter(e=>{if(!A||!A.from)return!0;let t=new Date(e.startTime),s=A.to||A.from;return t>=A.from&&t<=T(s)}):[],[E,s,A]),es=(0,i.useMemo)(()=>et.reduce((e,t)=>e+t.duration,0),[et]),er=(0,i.useMemo)(()=>et.reduce((e,t)=>e+t.duration/3600*t.billableRate,0),[et]),ei=async e=>{try{await (0,Z.Q_)(e.id,e),F(t=>t.map(t=>t.id===e.id?{...t,...e}:t)),V({title:"Entry Updated",description:"Your changes have been saved."})}catch(e){V({variant:"destructive",title:"Update Failed",description:e.message})}},en=async()=>{if(J)try{await (0,Z.Zs)(J.id),F(e=>e.filter(e=>e.id!==J.id)),V({title:"Entry Deleted",description:`The log entry "${J.subject}" has been removed.`})}catch(e){V({variant:"destructive",title:"Delete Failed",description:e.message})}finally{X(null)}},ea=e.find(e=>e.id===E);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"p-4 sm:p-6 space-y-6",children:[(0,r.jsxs)("header",{className:"flex items-center justify-between print:hidden",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Client Time Log Report"}),r.jsx("p",{className:"text-muted-foreground",children:"Generate a detailed report of time logged for a client."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(o.z,{variant:"outline",onClick:()=>{if(!ea||0===et.length){V({variant:"destructive",title:"Cannot Create Invoice",description:"Please select a client with time log entries in the selected range."});return}let e=et.filter(e=>e.billableRate>0&&e.duration>0).map(e=>{let t=e.duration/3600;return{description:`${e.subject} - ${(0,q.WU)(e.startTime,"PPP")}`,quantity:parseFloat(t.toFixed(2)),price:e.billableRate}});if(0===e.length){V({variant:"destructive",title:"No Billable Items",description:"There are no billable time entries in this report."});return}try{let t={contactId:ea.contactId,lineItems:e};sessionStorage.setItem("invoiceFromReportData",JSON.stringify(t)),ee.push("/accounting/invoices/create")}catch(e){console.error("Failed to prepare invoice data:",e),V({variant:"destructive",title:"Error",description:"Could not prepare the invoice data for generation."})}},disabled:!E,children:[r.jsx(m.Z,{className:"mr-2 h-4 w-4"}),"Create Invoice"]}),(0,r.jsxs)(o.z,{variant:"outline",onClick:Q,disabled:!E,children:[r.jsx(p.Z,{className:"mr-2 h-4 w-4"}),"Print Report"]}),r.jsx(o.z,{asChild:!0,children:(0,r.jsxs)(n.default,{href:"/client-manager",children:[r.jsx(j.Z,{className:"mr-2 h-4 w-4"}),"Back to Client Hub"]})})]})]}),(0,r.jsxs)(u.Zb,{className:"print:hidden",children:[r.jsx(u.Ol,{children:r.jsx(u.ll,{children:"Report Filters"})}),(0,r.jsxs)(u.aY,{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(h.Label,{children:"Client"}),(0,r.jsxs)(l.J2,{open:I,onOpenChange:G,children:[r.jsx(l.xo,{asChild:!0,children:(0,r.jsxs)(o.z,{variant:"outline",role:"combobox",className:"w-full justify-between",children:[ea?.name||"Select client...",r.jsx(g.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),r.jsx(l.yk,{className:"w-[--radix-popover-trigger-width] p-0",children:(0,r.jsxs)(c.mY,{children:[r.jsx(c.sZ,{placeholder:"Search clients..."}),(0,r.jsxs)(c.e8,{children:[r.jsx(c.rb,{children:O?r.jsx(f.Z,{className:"h-4 w-4 animate-spin"}):"No client found."}),r.jsx(c.fu,{children:e.map(e=>(0,r.jsxs)(c.di,{value:e.name,onSelect:()=>{U(e.id),G(!1)},children:[" ",r.jsx(v.Z,{className:(0,L.cn)("mr-2 h-4 w-4",E===e.id?"opacity-100":"opacity-0")}),e.name]},e.id))})]})]})})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(h.Label,{children:"Date Range"}),(0,r.jsxs)(l.J2,{children:[r.jsx(l.xo,{asChild:!0,children:(0,r.jsxs)(o.z,{variant:"outline",className:(0,L.cn)("w-full justify-start text-left font-normal",!A&&"text-muted-foreground"),children:[r.jsx(y.Z,{className:"mr-2 h-4 w-4"}),A?.from?A.to?`${(0,q.WU)(A.from,"LLL dd, y")} - ${(0,q.WU)(A.to,"LLL dd, y")}`:(0,q.WU)(A.from,"LLL dd, y"):r.jsx("span",{children:"Pick a date range"})]})}),r.jsx(l.yk,{className:"w-auto p-0",align:"start",children:r.jsx(d.f,{initialFocus:!0,mode:"range",defaultMonth:A?.from,selected:A,onSelect:W,numberOfMonths:2})})]})]}),(0,r.jsxs)("div",{className:"flex items-end gap-2",children:[r.jsx(o.z,{variant:"secondary",onClick:()=>W({from:(0,P.N)(new Date),to:new Date}),className:"w-full",children:"Month to Date"}),r.jsx(o.z,{variant:"secondary",onClick:()=>W({from:(0,C.e)(new Date),to:new Date}),className:"w-full",children:"Year to Date"}),r.jsx(o.z,{variant:"secondary",onClick:()=>W(void 0),className:"w-full",children:"Clear"})]})]})]}),r.jsx("div",{ref:K,children:(0,r.jsxs)(u.Zb,{className:"print:border-none print:shadow-none",children:[(0,r.jsxs)(u.Ol,{className:"text-center",children:[(0,r.jsxs)(u.ll,{className:"text-2xl",children:[ea?.name||"Client"," - Time Report"]}),r.jsx(u.SZ,{children:A?.from?A.to?`${(0,q.WU)(A.from,"PPP")} to ${(0,q.WU)(A.to,"PPP")}`:`On ${(0,q.WU)(A.from,"PPP")}`:"All time"})]}),r.jsx(u.aY,{children:O?r.jsx("div",{className:"h-48 flex items-center justify-center",children:r.jsx(f.Z,{className:"h-8 w-8 animate-spin"})}):E?(0,r.jsxs)(x.iA,{children:[r.jsx(x.xD,{children:(0,r.jsxs)(x.SC,{children:[r.jsx(x.ss,{children:"Date"}),r.jsx(x.ss,{children:"Subject"}),r.jsx(x.ss,{className:"text-right",children:"Duration"}),r.jsx(x.ss,{className:"text-right",children:"Billable"}),r.jsx(x.ss,{className:"w-10",children:r.jsx("span",{className:"sr-only",children:"Actions"})})]})}),r.jsx(x.RM,{children:et.length>0?et.map(e=>(0,r.jsxs)(x.SC,{children:[r.jsx(x.pj,{children:(0,q.WU)(e.startTime,"yyyy-MM-dd")}),r.jsx(x.pj,{children:e.subject}),r.jsx(x.pj,{className:"text-right font-mono",children:$(e.duration)}),(0,r.jsxs)(x.pj,{className:"text-right font-mono",children:["$",(e.duration/3600*e.billableRate).toFixed(2)]}),r.jsx(x.pj,{children:(0,r.jsxs)(k.h_,{children:[r.jsx(k.$F,{asChild:!0,children:r.jsx(o.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:r.jsx(b.Z,{className:"h-4 w-4"})})}),(0,r.jsxs)(k.AW,{align:"end",children:[(0,r.jsxs)(k.Xi,{onSelect:()=>B(e),children:[r.jsx(N.Z,{className:"mr-2 h-4 w-4"}),"Open / Edit"]}),(0,r.jsxs)(k.Xi,{className:"text-destructive",onSelect:()=>X(e),children:[r.jsx(w.Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id)):r.jsx(x.SC,{children:r.jsx(x.pj,{colSpan:5,className:"h-24 text-center",children:"No entries found for this period."})})}),r.jsx(x.yt,{children:(0,r.jsxs)(x.SC,{children:[r.jsx(x.pj,{colSpan:2,className:"font-bold",children:"Totals"}),r.jsx(x.pj,{className:"text-right font-bold font-mono",children:$(es)}),(0,r.jsxs)(x.pj,{className:"text-right font-bold font-mono",children:["$",er.toFixed(2)]}),r.jsx(x.pj,{})]})})]}):r.jsx("div",{className:"h-48 flex items-center justify-center",children:r.jsx("p",{className:"text-muted-foreground",children:"Please select a client to generate a report."})})})]})})]}),r.jsx(R.Z,{isOpen:!!Y,onOpenChange:()=>B(null),entry:Y,onSave:ei}),r.jsx(M.aR,{open:!!J,onOpenChange:()=>X(null),children:(0,r.jsxs)(M._T,{children:[(0,r.jsxs)(M.fY,{children:[r.jsx(M.f$,{children:"Are you absolutely sure?"}),(0,r.jsxs)(M.yT,{children:['This action will permanently delete the log entry: "',J?.subject,'". This cannot be undone.']})]}),(0,r.jsxs)(M.xo,{children:[r.jsx(M.le,{children:"Cancel"}),r.jsx(M.OL,{onClick:en,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})})]})}},10875:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(19510),i=s(68570);let n=(0,i.createProxy)(String.raw`/home/user/studio/src/components/client-manager/logged-entries-view.tsx`),{__esModule:a,$$typeof:l}=n;n.default;let o=(0,i.createProxy)(String.raw`/home/user/studio/src/components/client-manager/logged-entries-view.tsx#LoggedEntriesView`);function c(){return r.jsx(o,{})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,7514,6621,2371,7040,6458,6999,7344,8181,621,172,83,8606,5338,3928],()=>s(19021));module.exports=r})();
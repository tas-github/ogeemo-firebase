(()=>{var e={};e.id=561,e.ids=[561],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},68729:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>l}),r(92208),r(25215),r(35866),r(20306);var s=r(23191),n=r(88716),i=r(37922),a=r.n(i),c=r(95231),o={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>c[e]);r.d(t,o);let l=["",{children:["(app)",{children:["accounting",{children:["accounts-receivable",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,92208)),"/home/user/studio/src/app/(app)/accounting/accounts-receivable/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,25215)),"/home/user/studio/src/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,20306)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/home/user/studio/src/app/(app)/accounting/accounts-receivable/page.tsx"],u="/(app)/accounting/accounts-receivable/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(app)/accounting/accounts-receivable/page",pathname:"/accounting/accounts-receivable",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},72387:(e,t,r)=>{Promise.resolve().then(r.bind(r,933)),Promise.resolve().then(r.bind(r,46618)),Promise.resolve().then(r.bind(r,992))},992:(e,t,r)=>{"use strict";r.r(t),r.d(t,{InvoicePaymentsView:()=>w});var s=r(10326),n=r(17577),i=r(35047),a=r(29752),c=r(41156),o=r(38443),l=r(91664),d=r(41190),u=r(44794),x=r(24118),m=r(55296),p=r(10143),h=r(46721),g=r(14289),v=r(43022);let j=(0,r(9664).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var y=r(84736),f=r(37084),b=r(43821),N=r(84097),P=r(98181),S=r(68136),q=r(51920);function w(){let[e,t]=(0,n.useState)([]),[r,w]=(0,n.useState)(!0),[A,D]=(0,n.useState)(!1),[C,I]=(0,n.useState)(null),[_,Z]=(0,n.useState)(""),[k,M]=(0,n.useState)(null),{toast:O}=(0,N.pm)(),U=(0,i.useRouter)(),{user:F}=(0,S.a)(),V=(0,n.useMemo)(()=>e.reduce((e,t)=>{let r=t.originalAmount-t.amountPaid;return e+(r>0?r:0)},0),[e]),E=e=>{I(e);let t=e.originalAmount-e.amountPaid;Z(t>0?parseFloat(t.toFixed(2)):""),D(!0)},R=async()=>{if(!C||""===_||0>=Number(_)){O({variant:"destructive",title:"Invalid Amount",description:"Please enter a valid payment amount."});return}try{let e=C.amountPaid+Number(_);await (0,q.e9)(C.id,{amountPaid:e},[]),t(t=>t.map(t=>t.id===C.id?{...t,amountPaid:e}:t)),O({title:"Payment Recorded",description:`Payment of ${Number(_).toLocaleString("en-US",{style:"currency",currency:"USD"})} recorded.`}),D(!1),I(null),Z("")}catch(e){console.error("Failed to record payment:",e),O({variant:"destructive",title:"Error",description:"Could not record payment."})}},z=e=>{try{localStorage.setItem("editInvoiceId",e.id),U.push("/accounting/invoices/create")}catch(e){console.error("Failed to set invoice for editing:",e),O({variant:"destructive",title:"Error",description:"Could not prepare the invoice for editing."})}},L=async()=>{if(k)try{await (0,q.Wu)(k.id),t(e=>e.filter(e=>e.id!==k.id)),O({title:"Invoice Deleted",description:`Invoice ${k.invoiceNumber} has been removed.`})}catch(e){O({variant:"destructive",title:"Delete Failed",description:e.message})}finally{M(null)}},T=t=>{let r=e.filter(e=>e.clientName===t.clientName&&e.id!==t.id).reduce((e,t)=>e+(t.originalAmount-t.amountPaid),0);try{let e={...t,dueDate:t.dueDate.toISOString(),invoiceDate:t.invoiceDate.toISOString(),createdAt:t.createdAt.toISOString()};sessionStorage.setItem("ogeemo-receipt-data",JSON.stringify({invoice:e,carryForwardAmount:r})),U.push("/accounting/invoices/receipt")}catch(e){console.error("Failed to set receipt data:",e),O({variant:"destructive",title:"Error",description:"Could not generate the receipt."})}},G=e=>e.originalAmount-e.amountPaid<=.001?{status:"Paid",badgeVariant:"secondary"}:e.amountPaid>0?{status:"Partially Paid",badgeVariant:"outline"}:new Date(e.dueDate)<new Date?{status:"Overdue",badgeVariant:"destructive"}:{status:"Outstanding",badgeVariant:"outline"};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"p-4 sm:p-6 space-y-6",children:[s.jsx(b.AccountingPageHeader,{pageTitle:"Accounts Receivable"}),(0,s.jsxs)("header",{className:"text-center",children:[s.jsx("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Accounts Receivable"}),s.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Manage all outstanding invoices and payments due from clients."})]}),(0,s.jsxs)(a.Zb,{children:[(0,s.jsxs)(a.Ol,{className:"flex-row justify-between items-start",children:[(0,s.jsxs)("div",{children:[s.jsx(a.ll,{children:"Outstanding Invoices"}),s.jsx(a.SZ,{children:"A list of all client invoices from the database."})]}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Balance Due"}),s.jsx("p",{className:"text-2xl font-bold text-primary",children:V.toLocaleString("en-US",{style:"currency",currency:"USD"})})]})]}),s.jsx(a.aY,{children:s.jsx("div",{className:"border rounded-md",children:(0,s.jsxs)(c.iA,{children:[s.jsx(c.xD,{children:(0,s.jsxs)(c.SC,{children:[s.jsx(c.ss,{children:"Invoice #"}),s.jsx(c.ss,{children:"Client"}),s.jsx(c.ss,{children:"Due Date"}),s.jsx(c.ss,{className:"text-right",children:"Original Amount"}),s.jsx(c.ss,{className:"text-right",children:"Amount Paid"}),s.jsx(c.ss,{className:"text-right",children:"Balance Due"}),s.jsx(c.ss,{className:"text-center",children:"Status"}),s.jsx(c.ss,{className:"text-right",children:"Actions"})]})}),s.jsx(c.RM,{children:r?s.jsx(c.SC,{children:s.jsx(c.pj,{colSpan:8,className:"text-center h-24",children:s.jsx(h.Z,{className:"mx-auto h-6 w-6 animate-spin"})})}):e.length>0?e.map(e=>{let{status:t,badgeVariant:r}=G(e),n=e.originalAmount-e.amountPaid;return(0,s.jsxs)(c.SC,{children:[s.jsx(c.pj,{children:e.invoiceNumber}),s.jsx(c.pj,{children:e.clientName}),s.jsx(c.pj,{children:(0,P.WU)(new Date(e.dueDate),"PP")}),s.jsx(c.pj,{className:"text-right font-mono",children:e.originalAmount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),s.jsx(c.pj,{className:"text-right font-mono text-green-600",children:e.amountPaid.toLocaleString("en-US",{style:"currency",currency:"USD"})}),s.jsx(c.pj,{className:"text-right font-mono",children:n.toLocaleString("en-US",{style:"currency",currency:"USD"})}),s.jsx(c.pj,{className:"text-center",children:s.jsx(o.C,{variant:r,className:"secondary"===r?"bg-green-100 text-green-800":"",children:t})}),s.jsx(c.pj,{className:"text-right",children:(0,s.jsxs)(p.h_,{children:[s.jsx(p.$F,{asChild:!0,children:s.jsx(l.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:s.jsx(g.Z,{className:"h-4 w-4"})})}),(0,s.jsxs)(p.AW,{align:"end",children:[(0,s.jsxs)(p.Xi,{onSelect:()=>T(e),children:[s.jsx(v.Z,{className:"mr-2 h-4 w-4"}),"View / Print Receipt"]}),(0,s.jsxs)(p.Xi,{onSelect:()=>z(e),children:[s.jsx(j,{className:"mr-2 h-4 w-4"}),"Edit Invoice"]}),(0,s.jsxs)(p.Xi,{onSelect:()=>E(e),disabled:"Paid"===t,children:[s.jsx(y.Z,{className:"mr-2 h-4 w-4"}),"Post Payment"]}),(0,s.jsxs)(p.Xi,{onSelect:()=>M(e),className:"text-destructive",children:[s.jsx(f.Z,{className:"mr-2 h-4 w-4"}),"Delete Invoice"]})]})]})})]},e.id)}):s.jsx(c.SC,{children:s.jsx(c.pj,{colSpan:8,className:"text-center h-24 text-muted-foreground",children:"No invoices found."})})})]})})})]})]}),s.jsx(x.Vq,{open:A,onOpenChange:D,children:(0,s.jsxs)(x.cZ,{children:[(0,s.jsxs)(x.fK,{children:[(0,s.jsxs)(x.$N,{children:["Post Payment for ",C?.invoiceNumber]}),s.jsx(x.Be,{children:"Enter the amount received. This will be added to your income ledger."})]}),(0,s.jsxs)("div",{className:"py-4 space-y-2",children:[s.jsx(u.Label,{htmlFor:"payment-amount",children:"Payment Amount"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-muted-foreground",children:"$"}),s.jsx(d.I,{id:"payment-amount",type:"number",placeholder:"0.00",value:_,onChange:e=>Z(""===e.target.value?"":Number(e.target.value)),className:"pl-7"})]})]}),(0,s.jsxs)(x.cN,{children:[s.jsx(l.z,{variant:"ghost",onClick:()=>D(!1),children:"Cancel"}),s.jsx(l.z,{onClick:R,children:"Post Payment"})]})]})}),s.jsx(m.aR,{open:!!k,onOpenChange:()=>M(null),children:(0,s.jsxs)(m._T,{children:[(0,s.jsxs)(m.fY,{children:[s.jsx(m.f$,{children:"Are you sure?"}),(0,s.jsxs)(m.yT,{children:["This will permanently delete invoice ",k?.invoiceNumber," and all of its data."]})]}),(0,s.jsxs)(m.xo,{children:[s.jsx(m.le,{children:"Cancel"}),s.jsx(m.OL,{onClick:L,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})})]})}},38443:(e,t,r)=>{"use strict";r.d(t,{C:()=>c});var s=r(10326);r(17577);var n=r(79360),i=r(51223);let a=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function c({className:e,variant:t,...r}){return s.jsx("div",{className:(0,i.cn)(a({variant:t}),e),...r})}},92208:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(19510),n=r(55782),i=r(53397);let a=(0,n.default)(()=>r.e(7213).then(r.bind(r,17213)).then(e=>e.InvoicePaymentsView),{loadableGenerated:{modules:["app/(app)/accounting/accounts-receivable/page.tsx -> @/components/accounting/invoice-payments-view"]},ssr:!1,loading:()=>s.jsx("div",{className:"flex h-full w-full items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[s.jsx(i.Z,{className:"h-10 w-10 animate-spin text-primary"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading Accounts Receivable..."})]})})});function c(){return s.jsx(a,{})}},14711:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(9664).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},43022:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(9664).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,7514,6621,2371,7040,6458,7344,8181,3114,8606,5338,450,3387],()=>r(68729));module.exports=s})();
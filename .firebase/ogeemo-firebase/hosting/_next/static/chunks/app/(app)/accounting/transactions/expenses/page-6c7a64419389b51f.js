(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2467],{78683:function(e,s,t){Promise.resolve().then(t.bind(t,10912)),Promise.resolve().then(t.bind(t,61481)),Promise.resolve().then(t.bind(t,78908))},78908:function(e,s,t){"use strict";t.r(s),t.d(s,{ExpenseView:function(){return L}});var a=t(57437),n=t(2265),l=t(87138),i=t(47304),c=t(48185),r=t(89733),d=t(3409),o=t(80822),x=t(38087),m=t(91241),h=t(69893),p=t(8527),u=t(19847),j=t(47949),g=t(31590),N=t(54662),y=t(29943),v=t(77209),f=t(70402),b=t(2128),C=t(86763),S=t(80112),w=t(19779),E=t(76598);let F={date:"",company:"",description:"",amount:"",category:"",explanation:"",documentNumber:"",type:"business"},k=["Utilities","Software","Office Supplies","Contractors","Marketing","Travel","Meals"],D=["Cloud Hosting Inc.","SaaS Tools Co.","Office Supply Hub","Jane Designs"];function L(){let[e,s]=n.useState([]),[t,L]=n.useState(!0),{user:T}=(0,w.a)(),[Z,A]=n.useState(k),[I,O]=n.useState(D),[_,P]=n.useState(!1),[U,V]=n.useState(null),[z,M]=n.useState(null),[X,$]=n.useState(F),[B,R]=n.useState(""),{toast:Y}=(0,C.pm)();n.useEffect(()=>{if(!T){L(!1);return}(async()=>{L(!0);try{let e=await (0,E.uu)(T.uid);s(e)}catch(e){Y({variant:"destructive",title:"Failed to load expense data",description:e.message})}finally{L(!1)}})()},[T,Y]);let q=e=>{e?(V(e),$({date:e.date,company:e.company,description:e.description,amount:String(e.amount),category:e.category,explanation:e.explanation||"",documentNumber:e.documentNumber||"",type:e.type||"business"})):(V(null),$(F)),P(!0)},H=async()=>{if(!T)return;let e=parseFloat(X.amount);if(!X.date||!X.company||!X.category||!X.amount||isNaN(e)||e<=0){Y({variant:"destructive",title:"Invalid Input",description:"Please fill all required fields correctly."});return}let t={date:X.date,description:X.description.trim(),amount:e,category:X.category,company:X.company.trim(),explanation:X.explanation.trim(),documentNumber:X.documentNumber.trim(),type:X.type};try{if(U)await (0,E.rV)(U.id,t),s(e=>e.map(e=>e.id===U.id?{...e,...t}:e)),Y({title:"Expense Transaction Updated"});else{let e=await (0,E.mU)({...t,userId:T.uid});s(s=>[e,...s]),Y({title:"Expense Transaction Added"})}P(!1)}catch(e){Y({variant:"destructive",title:"Save Failed",description:e.message})}},Q=async()=>{if(z)try{await (0,E.NY)(z.id),s(e=>e.filter(e=>e.id!==z.id)),Y({title:"Transaction Deleted"})}catch(e){Y({variant:"destructive",title:"Delete Failed",description:e.message})}finally{M(null)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-4 sm:p-6 space-y-6",children:[(0,a.jsx)(j.X,{pageTitle:"Manage Expenses"}),(0,a.jsxs)("header",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Expenses"}),(0,a.jsx)("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Review and manage all business expenditures."})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c.ll,{children:"Expense Transactions"}),(0,a.jsx)(c.SZ,{children:"A list of all recorded expenses."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.z,{asChild:!0,variant:"outline",children:(0,a.jsxs)(l.default,{href:"/accounting/transactions/income",children:[(0,a.jsx)(d.Z,{className:"mr-2 h-4 w-4"})," Go to Income"]})}),(0,a.jsxs)(r.z,{variant:"outline",onClick:()=>q(),children:[(0,a.jsx)(o.Z,{className:"mr-2 h-4 w-4"})," Add Expense"]})]})]}),(0,a.jsx)(c.aY,{children:t?(0,a.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,a.jsx)(x.Z,{className:"h-8 w-8 animate-spin"})}):(0,a.jsxs)(i.iA,{children:[(0,a.jsx)(i.xD,{children:(0,a.jsxs)(i.SC,{children:[(0,a.jsx)(i.ss,{children:"Date"}),(0,a.jsx)(i.ss,{children:"Company"}),(0,a.jsx)(i.ss,{children:"Description"}),(0,a.jsx)(i.ss,{children:"Category"}),(0,a.jsx)(i.ss,{className:"text-right",children:"Amount"}),(0,a.jsx)(i.ss,{children:(0,a.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,a.jsx)(i.RM,{children:e.map(e=>(0,a.jsxs)(i.SC,{children:[(0,a.jsx)(i.pj,{children:e.date}),(0,a.jsx)(i.pj,{children:e.company}),(0,a.jsx)(i.pj,{children:e.description}),(0,a.jsx)(i.pj,{children:e.category}),(0,a.jsxs)(i.pj,{className:"text-right font-mono text-red-600",children:["(",e.amount.toLocaleString("en-US",{style:"currency",currency:"USD"}),")"]}),(0,a.jsx)(i.pj,{children:(0,a.jsxs)(g.h_,{children:[(0,a.jsx)(g.$F,{asChild:!0,children:(0,a.jsxs)(r.z,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,a.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,a.jsx)(m.Z,{className:"h-4 w-4"})]})}),(0,a.jsxs)(g.AW,{align:"end",children:[(0,a.jsxs)(g.Xi,{onSelect:()=>q(e),children:[(0,a.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Open"]}),(0,a.jsxs)(g.Xi,{onSelect:()=>q(e),children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,a.jsxs)(g.Xi,{className:"text-destructive",onSelect:()=>M(e),children:[(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id))})]})})]})]}),(0,a.jsx)(N.Vq,{open:_,onOpenChange:P,children:(0,a.jsxs)(N.cZ,{children:[(0,a.jsx)(N.fK,{className:"text-center sm:text-center",children:(0,a.jsx)(N.$N,{className:"text-2xl text-primary",children:U?"Edit Expense":"Add Expense"})}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsxs)(f.Label,{htmlFor:"tx-date",className:"text-right",children:["Date ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(v.I,{id:"tx-date",type:"date",value:X.date,onChange:e=>$(s=>({...s,date:e.target.value})),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsxs)(f.Label,{htmlFor:"tx-company",className:"text-right",children:["Company ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)("div",{className:"col-span-3 flex items-center gap-2",children:(0,a.jsxs)(b.Ph,{value:X.company,onValueChange:e=>$(s=>({...s,company:e})),children:[(0,a.jsx)(b.i4,{id:"tx-company",className:"w-full",children:(0,a.jsx)(b.ki,{placeholder:"Select or add a company"})}),(0,a.jsx)(b.Bw,{children:I.map(e=>(0,a.jsx)(b.Ql,{value:e,children:e},e))})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f.Label,{htmlFor:"tx-doc-number",className:"text-right",children:"Document #"}),(0,a.jsx)(v.I,{id:"tx-doc-number",value:X.documentNumber,onChange:e=>$(s=>({...s,documentNumber:e.target.value})),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f.Label,{htmlFor:"tx-description",className:"text-right",children:"Description"}),(0,a.jsx)(v.I,{id:"tx-description",value:X.description,onChange:e=>$(s=>({...s,description:e.target.value})),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsxs)(f.Label,{htmlFor:"tx-amount",className:"text-right",children:["Amount ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsxs)("div",{className:"relative col-span-3",children:[(0,a.jsx)("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-muted-foreground",children:"$"}),(0,a.jsx)(v.I,{id:"tx-amount",type:"number",value:X.amount,onChange:e=>$(s=>({...s,amount:e.target.value})),className:"pl-7",step:"0.01",placeholder:"0.00"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsxs)(f.Label,{htmlFor:"tx-category",className:"text-right",children:["Category ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)("div",{className:"col-span-3 flex items-center gap-2",children:(0,a.jsxs)(b.Ph,{value:X.category,onValueChange:e=>$(s=>({...s,category:e})),children:[(0,a.jsx)(b.i4,{className:"w-full",children:(0,a.jsx)(b.ki,{placeholder:"Select a category"})}),(0,a.jsx)(b.Bw,{children:Z.map(e=>(0,a.jsx)(b.Ql,{value:e,children:e},e))})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f.Label,{htmlFor:"tx-explanation",className:"text-right",children:"Explanation"}),(0,a.jsx)(v.I,{id:"tx-explanation",value:X.explanation,onChange:e=>$(s=>({...s,explanation:e.target.value})),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f.Label,{htmlFor:"tx-type",className:"text-right",children:"Type"}),(0,a.jsxs)(S.E,{value:X.type,onValueChange:e=>$(s=>({...s,type:e})),className:"col-span-3 flex items-center space-x-4",id:"tx-type",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(S.m,{value:"business",id:"type-business-exp"}),(0,a.jsx)(f.Label,{htmlFor:"type-business-exp",children:"Business"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(S.m,{value:"personal",id:"type-personal-exp"}),(0,a.jsx)(f.Label,{htmlFor:"type-personal-exp",children:"Personal"})]})]})]})]}),(0,a.jsxs)(N.cN,{children:[(0,a.jsx)(r.z,{variant:"ghost",onClick:()=>P(!1),children:"Cancel"}),(0,a.jsx)(r.z,{onClick:H,children:U?"Save Changes":"Save Expense"})]})]})}),(0,a.jsx)(y.aR,{open:!!z,onOpenChange:()=>M(null),children:(0,a.jsxs)(y._T,{children:[(0,a.jsxs)(y.fY,{children:[(0,a.jsx)(y.f$,{children:"Are you sure?"}),(0,a.jsxs)(y.yT,{children:['This action will permanently delete the transaction: "',null==z?void 0:z.description,'".']})]}),(0,a.jsxs)(y.xo,{children:[(0,a.jsx)(y.le,{children:"Cancel"}),(0,a.jsx)(y.OL,{onClick:Q,className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})})]})}},3409:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(6497).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])}},function(e){e.O(0,[4358,4728,2641,231,7255,4086,5510,9279,3070,6680,2827,6669,9249,7322,9554,2971,7023,1744],function(){return e(e.s=78683)}),_N_E=e.O()}]);
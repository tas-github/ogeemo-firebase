(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7121],{94882:function(e,t,r){Promise.resolve().then(r.bind(r,10912)),Promise.resolve().then(r.bind(r,61481)),Promise.resolve().then(r.bind(r,48423))},58064:function(e,t,r){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return n}});let a=r(74590);function n(e){let{createServerReference:t}=r(6671);return t(e,a.callServer)}},10912:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let a=r(55592);function n(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new a.BailoutToCSRError(t);return r}},61481:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return l}});let a=r(57437),n=r(58512);function l(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=(0,n.getExpectedRequestStore)("next/dynamic css"),l=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));l.push(...t)}}return 0===l.length?null:(0,a.jsx)(a.Fragment,{children:l.map(e=>(0,a.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},48423:function(e,t,r){"use strict";r.r(t),r.d(t,{TimeManagerView:function(){return k}});var a=r(57437),n=r(2265),l=r(48185),i=r(89733),s=r(77209),c=r(70402),o=r(2128),d=r(38087),u=r(49489),f=r(25695),m=r(94729),h=r(67188),x=r(25648),p=r(86763),g=r(19779),v=r(50215),b=r(56147),j=r(68965),N=r(44541),w=r(4919),y=r(78240);let S="activeTimeManagerEntry",C=e=>{e<0&&(e=0);let t=Math.floor(e/3600),r=Math.floor(e%3600/60),a=Math.floor(e%60);return"".concat(String(t).padStart(2,"0"),":").concat(String(r).padStart(2,"0"),":").concat(String(a).padStart(2,"0"))};function k(){let[e,t]=(0,n.useState)(0),[r,k]=(0,n.useState)(!1),[R,P]=(0,n.useState)(!1),[I,M]=(0,n.useState)(""),[E,T]=(0,n.useState)(""),[O,Z]=(0,n.useState)(null),[L,D]=(0,n.useState)(null),[F,_]=(0,n.useState)(!0),[z,B]=(0,n.useState)(100),[$,J]=(0,n.useState)(!1),[q,A]=(0,n.useState)({}),[W,Q]=(0,n.useState)([]),[V,Y]=(0,n.useState)([]),[H,K]=(0,n.useState)(!0),{user:U}=(0,g.a)(),{toast:X}=(0,p.pm)(),G=(0,n.useCallback)(()=>{try{let e=localStorage.getItem(S);if(e){let r=JSON.parse(e);if(r.isActive){if(k(!0),P(r.isPaused),M(r.subject),T(r.notes),Z(r.projectId),D(r.contactId),_(r.isBillable),B(r.billableRate),r.isPaused){let e=Math.floor((r.pauseTime-r.startTime)/1e3)-r.totalPausedDuration;t(e>0?e:0)}else{let e=Date.now(),a=Math.floor((e-r.startTime)/1e3)-r.totalPausedDuration;t(a>0?a:0)}}else k(!1)}else k(!1),t(0)}catch(e){console.error("Error reading timer state",e),k(!1)}},[]);(0,n.useEffect)(()=>{G(),window.addEventListener("storage",G);let e=setInterval(G,1e3);return()=>{clearInterval(e),window.removeEventListener("storage",G)}},[G]),(0,n.useEffect)(()=>{(async function(){if(!U){K(!1);return}K(!0);try{let[e,t]=await Promise.all([(0,v.mW)(U.uid),(0,b.K2)(U.uid)]);Q(e),Y(t)}catch(e){X({variant:"destructive",title:"Failed to load data",description:e.message})}finally{K(!1)}})()},[U,X]);let ee=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];t(0),M(""),T(""),D(null),Z(null),_(!0),B(100),localStorage.removeItem(S),window.dispatchEvent(new Event("storage")),e&&X({title:"Timer Reset",description:"The timer and fields have been cleared."})},et=async()=>{if(!U||e<=0)return;let t=V.find(e=>e.id===L);if(!t){X({variant:"destructive",title:"Client Required",description:"Please select a client to log time."});return}if(!W.find(e=>e.id===O)){X({variant:"destructive",title:"Project Required",description:"Please select a project to log time against."});return}let r=F&&Number(z)||0,a={accountId:t.id,contactName:t.name,subject:I||"Time Entry",detailsHtml:E.replace(/\n/g,"<br>"),startTime:new Date(Date.now()-1e3*e),endTime:new Date,duration:e,billableRate:r,userId:U.uid};try{await (0,j.MO)(a),X({title:"Time Logged",description:"Logged ".concat(C(e)," for ").concat(t.name)}),ee(!1)}catch(e){X({variant:"destructive",title:"Log Failed",description:e.message})}},er=(e,t)=>{let r=localStorage.getItem(S);if(r){let a=JSON.parse(r);a[e]=t,localStorage.setItem(S,JSON.stringify(a)),window.dispatchEvent(new Event("storage"))}},ea=async e=>{if(!U){X({variant:"destructive",title:"Error",description:"You must be logged in to create events."});return}try{await (0,v.gI)({...e,userId:U.uid}),X({title:"Event Scheduled",description:'"'.concat(e.title,'" has been added to your calendar.')}),ee(!1)}catch(e){X({variant:"destructive",title:"Failed to create event",description:e.message})}};return H?(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsx)(d.Z,{className:"h-10 w-10 animate-spin text-primary"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-4 sm:p-6 space-y-6 flex flex-col items-center",children:[(0,a.jsx)("header",{className:"relative w-full max-w-4xl",children:(0,a.jsxs)("div",{className:"relative flex justify-center items-center",children:[(0,a.jsx)("div",{className:"flex items-center gap-3 absolute left-0",children:(0,a.jsx)(u.Z,{className:"h-8 w-8 text-primary"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Event Time Manager"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Track your time time against all events and check the box if the event is billable"})]}),(0,a.jsxs)("div",{className:"text-right absolute right-0",children:[(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"Time Logged"}),(0,a.jsx)("p",{className:"text-2xl font-mono font-bold text-primary tracking-tighter",children:C(e)})]})]})}),(0,a.jsxs)(l.Zb,{className:"w-full max-w-4xl",children:[(0,a.jsxs)(l.aY,{className:"pt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"project",children:"Project"}),(0,a.jsxs)(o.Ph,{value:O||"",onValueChange:e=>{Z(e),r&&er("projectId",e)},disabled:r,children:[(0,a.jsx)(o.i4,{id:"project",children:(0,a.jsx)(o.ki,{placeholder:"Select a project..."})}),(0,a.jsx)(o.Bw,{children:W.map(e=>(0,a.jsx)(o.Ql,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"client",children:"Client"}),(0,a.jsxs)(o.Ph,{value:L||"",onValueChange:e=>{D(e),r&&er("contactId",e)},disabled:r,children:[(0,a.jsx)(o.i4,{id:"client",children:(0,a.jsx)(o.ki,{placeholder:"Select a client..."})}),(0,a.jsx)(o.Bw,{children:V.map(e=>(0,a.jsx)(o.Ql,{value:e.id,children:e.name},e.id))})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"subject",children:"Subject"}),(0,a.jsx)(s.I,{id:"subject",placeholder:"What is the main task?",value:I,onChange:e=>{let t=e.target.value;M(t),r&&er("subject",t)}})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"notes",children:"Notes / Details"}),(0,a.jsx)(w.g,{id:"notes",placeholder:"Add more details about the work...",value:E,onChange:e=>{let t=e.target.value;T(t),r&&er("notes",t)},rows:8})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(N.Checkbox,{id:"is-billable",checked:F,onCheckedChange:e=>{let t=!!e;_(t),r&&(er("isBillable",t),t||er("billableRate",0))}}),(0,a.jsx)(c.Label,{htmlFor:"is-billable",className:"font-medium",children:"Billable"})]}),F&&(0,a.jsxs)("div",{className:"space-y-2 w-48 animate-in fade-in-50 duration-300",children:[(0,a.jsx)(c.Label,{htmlFor:"billable-rate",children:"Rate ($/hr)"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-muted-foreground",children:"$"}),(0,a.jsx)(s.I,{id:"billable-rate",type:"number",placeholder:"100",value:z,onChange:e=>{let t=""===e.target.value?"":Number(e.target.value);B(t),r&&er("billableRate",Number(t)||0)},className:"pl-7"})]})]})]})]}),(0,a.jsxs)(l.eW,{className:"flex-col sm:flex-row items-center justify-between gap-4",children:[(0,a.jsx)("div",{className:"flex gap-2",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.z,{size:"lg",variant:"outline",onClick:R?()=>{let e=localStorage.getItem(S);if(!e)return;let t=JSON.parse(e);if(t.pauseTime){let e=Math.floor((Date.now()-t.pauseTime)/1e3);t.totalPausedDuration+=e}t.isPaused=!1,t.pauseTime=null,localStorage.setItem(S,JSON.stringify(t)),window.dispatchEvent(new Event("storage"))}:()=>{let e=localStorage.getItem(S);if(!e)return;let t=JSON.parse(e);t.isPaused=!0,t.pauseTime=Date.now(),localStorage.setItem(S,JSON.stringify(t)),window.dispatchEvent(new Event("storage"))},children:[R?(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"}):(0,a.jsx)(h.Z,{className:"mr-2 h-5 w-5"}),R?"Resume":"Pause"]}),(0,a.jsxs)(i.z,{size:"lg",variant:"destructive",onClick:et,children:[(0,a.jsx)(x.Z,{className:"mr-2 h-5 w-5"})," Stop & Log Time"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.z,{size:"lg",onClick:()=>{let e={startTime:Date.now(),isActive:!0,isPaused:!1,pauseTime:null,totalPausedDuration:0,projectId:O,contactId:L,subject:I,notes:E,isBillable:F,billableRate:F&&Number(z)||0};localStorage.setItem(S,JSON.stringify(e)),window.dispatchEvent(new Event("storage"))},children:[(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"})," Start Timer Now"]}),(0,a.jsxs)(i.z,{size:"lg",variant:"outline",onClick:()=>{A({title:I,description:E,contactId:L,projectId:O}),J(!0)},children:[(0,a.jsx)(m.Z,{className:"mr-2 h-5 w-5"})," Save Event to Calendar"]})]})}),(0,a.jsx)(i.z,{variant:"ghost",onClick:()=>ee(),children:"Reset"})]})]})]}),(0,a.jsx)(y.e,{isOpen:$,onOpenChange:J,onTaskCreate:ea,contacts:V,initialData:q,initialMode:"event"})]})}},48185:function(e,t,r){"use strict";r.d(t,{Ol:function(){return s},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return c}});var a=r(57437),n=r(2265),l=r(49354);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});i.displayName="Card";let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...n})});s.displayName="CardHeader";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});c.displayName="CardTitle";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...n})});o.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",r),...n})});d.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},44541:function(e,t,r){"use strict";r.d(t,{Checkbox:function(){return c}});var a=r(57437),n=r(2265),l=r(69324),i=r(60926),s=r(49354);let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(l.fC,{ref:t,className:(0,s.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...n,children:(0,a.jsx)(l.z$,{className:(0,s.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})})});c.displayName=l.fC.displayName},68965:function(e,t,r){"use strict";r.d(t,{MO:function(){return s},PZ:function(){return l},Q_:function(){return c},Zs:function(){return n},m:function(){return i}}),r(74590);var a=r(58064),n=(0,a.$)("4b9b469320d25787c9052e3c80581cdf7d307da6"),l=(0,a.$)("45c62e5cfe72bfd2427d90e30095e526b2070634"),i=(0,a.$)("331237979c21ae7d7e4e2d71d7f57f3bafb7c3ef"),s=(0,a.$)("7d0b620d35b8cfe2b05e4763f40aeae73e2080e7"),c=(0,a.$)("3f6c35eb09410213ec131362ebb959b485c3ea97")},90976:function(e,t,r){"use strict";r.d(t,{B:function(){return c}});var a=r(2265),n=r(98324),l=r(1584),i=r(71538),s=r(57437);function c(e){let t=e+"CollectionProvider",[r,c]=(0,n.b)(t),[o,d]=r(t,{collectionRef:{current:null},itemMap:new Map}),u=e=>{let{scope:t,children:r}=e,n=a.useRef(null),l=a.useRef(new Map).current;return(0,s.jsx)(o,{scope:t,itemMap:l,collectionRef:n,children:r})};u.displayName=t;let f=e+"CollectionSlot",m=a.forwardRef((e,t)=>{let{scope:r,children:a}=e,n=d(f,r),c=(0,l.e)(t,n.collectionRef);return(0,s.jsx)(i.g7,{ref:c,children:a})});m.displayName=f;let h=e+"CollectionItemSlot",x="data-radix-collection-item",p=a.forwardRef((e,t)=>{let{scope:r,children:n,...c}=e,o=a.useRef(null),u=(0,l.e)(t,o),f=d(h,r);return a.useEffect(()=>(f.itemMap.set(o,{ref:o,...c}),()=>void f.itemMap.delete(o))),(0,s.jsx)(i.g7,{[x]:"",ref:u,children:n})});return p.displayName=h,[{Provider:u,Slot:m,ItemSlot:p},function(t){let r=d(e+"CollectionConsumer",t);return a.useCallback(()=>{let e=r.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll("[".concat(x,"]")));return Array.from(r.itemMap.values()).sort((e,r)=>t.indexOf(e.ref.current)-t.indexOf(r.ref.current))},[r.collectionRef,r.itemMap])},c]}},87513:function(e,t,r){"use strict";r.d(t,{gm:function(){return l}});var a=r(2265);r(57437);var n=a.createContext(void 0);function l(e){let t=a.useContext(n);return e||t||"ltr"}},36473:function(e,t,r){"use strict";r.d(t,{t:function(){return i}});var a=r(11880),n=r(40071),l=r(74546);function i(e,t){let r=(0,l.Q)(e);return isNaN(+r)?(0,a.L)(e,NaN):(null!=t.year&&r.setFullYear(t.year),null!=t.month&&(r=(0,n.q)(r,t.month)),null!=t.date&&r.setDate(t.date),null!=t.hours&&r.setHours(t.hours),null!=t.minutes&&r.setMinutes(t.minutes),null!=t.seconds&&r.setSeconds(t.seconds),null!=t.milliseconds&&r.setMilliseconds(t.milliseconds),r)}},72563:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(6497).Z)("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]])},51601:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(6497).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},38087:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(6497).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},74732:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(6497).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[4358,4728,2641,7255,4086,5510,9279,3070,1792,1313,2827,1374,4694,8538,2393,4088,2971,7023,1744],function(){return e(e.s=94882)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2074],{4109:function(e,t,r){Promise.resolve().then(r.bind(r,10912)),Promise.resolve().then(r.bind(r,61481)),Promise.resolve().then(r.bind(r,24660))},24660:function(e,t,r){"use strict";r.r(t),r.d(t,{CalendarView:function(){return T}});var s=r(57437),a=r(2265),l=r(31313),n=r(36473),i=r(93275),d=r(82469),c=r(4192),o=r(1774),u=r(70218),m=r(33673),x=r(49105),h=r(72781),f=r(3107),p=r(78335),y=r(45158),v=r(38087),g=r(87640),b=r(51601),j=r(32515),N=r(94546),w=r(49354),M=r(89733),k=r(80023),E=r(86763),S=r(19779),C=r(50215),U=r(56147),W=r(78240);let z=e=>{let{event:t,style:r,className:a,onClick:n}=e,[{isDragging:i},d]=(0,j.c)(()=>({type:"event",item:t,collect:e=>({isDragging:e.isDragging()})}));return(0,s.jsxs)("div",{ref:d,style:{...r,opacity:i?.5:1},className:(0,w.cn)(a,"cursor-move"),onClick:n,children:[(0,s.jsx)("p",{className:"font-bold text-xs truncate",children:t.title}),(0,s.jsxs)("p",{className:"text-xs opacity-80 truncate",children:[(0,l.WU)(t.start,"p")," - ",(0,l.WU)(t.end,"p")]})]})},O=e=>{let{day:t,dayEvents:r,viewStartHour:d,viewEndHour:c,onEventDrop:o,onEventClick:u,hideHeader:m=!1,today:x}=e,h=Array.from({length:c-d+1},(e,t)=>t+d),f=60*h.length*2,p=a.useRef(null),[,y]=(0,N.L)(()=>({accept:"event",drop:(e,r)=>{if(!p.current)return;let s=p.current.getBoundingClientRect(),a=r.getClientOffset();if(!a)return;let l=Math.round((a.y-s.top)/2),i=d+Math.floor((l=Math.max(0,5*Math.round(l/5)))/60),c=l%60,u=(0,n.t)(t,{hours:i,minutes:c,seconds:0,milliseconds:0});o(e.id,u)}}));return y(p),(0,s.jsxs)("div",{className:(0,w.cn)("border-r last:border-r-0",m&&"border-t"),children:[!m&&(0,s.jsxs)("div",{className:"sticky top-0 z-10 h-16 border-b bg-background text-center",children:[(0,s.jsx)("p",{className:"text-sm font-semibold",children:(0,l.WU)(t,"EEE")}),(0,s.jsx)("p",{className:(0,w.cn)("text-2xl font-bold",x&&(0,i.K)(t,x)&&"text-primary"),children:(0,l.WU)(t,"d")})]}),(0,s.jsxs)("div",{ref:p,className:"relative",style:{height:"".concat(f,"px")},children:[h.map(e=>(0,s.jsx)("div",{className:"h-[120px] border-b"},"line-".concat(e,"-").concat(t.toISOString()))),r.map(e=>{let t=(e.start.getHours()-d)*60+e.start.getMinutes(),r=(e.end.getHours()-d)*60+e.end.getMinutes();return r<0||t>(c-d+1)*60?null:(0,s.jsx)(z,{event:e,style:{top:"".concat(2*t,"px"),height:"".concat(2*Math.max(15,r-t),"px")},className:"absolute left-1 right-1 rounded-lg bg-primary/20 p-2 border border-primary/50 overflow-hidden text-primary",onClick:()=>u(e)},e.id)})]})]})},D=e=>{let{date:t,events:r,onEventClick:a,today:n}=e,h=(0,d.N)(t),f=(0,c.V)(t),p=(0,o.z)(h,{weekStartsOn:1}),y=(0,u.v)(f,{weekStartsOn:1}),v=(0,m.D)({start:p,end:y});return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("header",{className:"grid grid-cols-7 flex-none text-center font-semibold text-sm text-muted-foreground border-t border-l border-r",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(e=>(0,s.jsx)("div",{className:"py-2 border-b border-r last:border-r-0",children:e},e))}),(0,s.jsx)(k.ScrollArea,{className:"flex-1",children:(0,s.jsx)("div",{className:"grid grid-cols-7 auto-rows-[minmax(120px,_1fr)] border-l",children:v.map(e=>{let d=r.filter(t=>(0,i.K)(t.start,e));return(0,s.jsxs)("div",{className:(0,w.cn)("border-b border-r p-2 flex flex-col",!(0,x.x)(e,t)&&"bg-muted/20"),children:[(0,s.jsx)("p",{className:(0,w.cn)("font-medium text-sm self-start",n&&(0,i.K)(e,n)&&"bg-primary text-primary-foreground rounded-full h-6 w-6 flex items-center justify-center",!(0,x.x)(e,t)&&"text-muted-foreground"),children:(0,l.WU)(e,"d")}),(0,s.jsx)("div",{className:"mt-1 space-y-1 overflow-hidden",children:d.map(e=>(0,s.jsx)("div",{className:"text-xs p-1 rounded bg-primary/20 text-primary truncate cursor-pointer",title:e.title,onClick:()=>a(e),children:e.title},e.id))})]},e.toString())})})})]})};function T(){let[e,t]=a.useState(),[r,n]=a.useState(null),[d,c]=a.useState("day"),[j,N]=a.useState([]),[z,T]=a.useState([]),[P,_]=a.useState(!0),[F]=a.useState(9),[A]=a.useState(17),[H,K]=a.useState(!1),[I,R]=a.useState(null),{toast:V}=(0,E.pm)(),{user:Y}=(0,S.a)();a.useEffect(()=>{let e=new Date;t(e),n(e)},[]);let Z=a.useCallback(async()=>{if(!Y){_(!1);return}_(!0);try{let[e,t]=await Promise.all([(0,C.FV)(Y.uid),(0,U.K2)(Y.uid)]);N(e),T(t)}catch(e){V({variant:"destructive",title:"Could not load data",description:e.message})}finally{_(!1)}},[Y,V]);a.useEffect(()=>{Z()},[Z]);let B=async e=>{if(!Y){V({variant:"destructive",title:"Error",description:"You must be logged in to create events."});return}try{let t=await (0,C.gI)({...e,userId:Y.uid});N(e=>[...e,t]),V({title:"Event Created"})}catch(e){V({variant:"destructive",title:"Failed to create event",description:e.message})}},J=async e=>{try{await (0,C.xJ)(e.id,e),N(t=>t.map(t=>t.id===e.id?{...t,...e}:t)),V({title:"Event Updated"})}catch(e){V({variant:"destructive",title:"Failed to update event",description:e.message})}},q=e=>{R(e),K(!0)},L=a.useMemo(()=>{if(!e)return"Select a date";let t=(e,t)=>e.getFullYear()!==t.getFullYear()?"".concat((0,l.WU)(e,"MMMM d, yyyy")," – ").concat((0,l.WU)(t,"MMMM d, yyyy")):(0,x.x)(e,t)?"".concat((0,l.WU)(e,"MMMM d")," – ").concat((0,l.WU)(t,"d, yyyy")):"".concat((0,l.WU)(e,"MMMM d")," – ").concat((0,l.WU)(t,"MMMM d, yyyy"));switch(d){case"day":return(0,l.WU)(e,"EEEE, MMMM d, yyyy");case"5days":{let r=(0,h.E)(e,4);return t(e,r)}case"week":return t((0,o.z)(e,{weekStartsOn:1}),(0,u.v)(e,{weekStartsOn:1}));case"month":return(0,l.WU)(e,"MMMM yyyy");default:return(0,l.WU)(e,"PPP")}},[e,d]),G=a.useCallback(async(e,t)=>{let r=j.find(t=>t.id===e);if(!r)return;let s=r.end.getTime()-r.start.getTime(),a=new Date(t.getTime()+s);try{await (0,C.xJ)(e,{start:t,end:a}),N(r=>r.map(r=>r.id===e?{...r,start:t,end:a}:r)),V({title:"Event Time Updated"})}catch(e){V({variant:"destructive",title:"Failed to update event time",description:e.message})}},[j,V]),Q=a.useMemo(()=>Array.from({length:A-F+1},(e,t)=>t+F),[F,A]),X=e=>{if(0===e.length)return null;let t=1===e.length;return(0,s.jsx)(k.ScrollArea,{className:"h-full w-full",children:(0,s.jsxs)("div",{className:"flex",style:{minWidth:80+150*e.length},children:[(0,s.jsxs)("div",{className:"sticky left-0 z-20 w-24 shrink-0 bg-background",children:[!t&&(0,s.jsx)("div",{className:"h-16 border-b border-r",children:"\xa0"}),(0,s.jsx)("div",{className:"pt-4",children:Q.map(e=>(0,s.jsx)("div",{className:"relative h-[120px] border-r text-right",children:(0,s.jsx)("p",{className:"absolute top-0 right-2 -translate-y-1/2 bg-background px-1 text-xs text-muted-foreground",children:(0,l.WU)((0,y.B)(new Date,e),"ha")})},"time-gutter-".concat(e)))})]}),(0,s.jsx)("div",{className:"grid flex-1",style:{gridTemplateColumns:"repeat(".concat(e.length,", minmax(150px, 1fr))")},children:e.map((e,a)=>{let l=j.filter(t=>(0,i.K)(t.start,e));return(0,s.jsx)("div",{className:(0,w.cn)(0===a&&"col-start-1 -ml-24 pl-24"),children:(0,s.jsx)("div",{className:"pt-4",children:(0,s.jsx)(O,{day:e,dayEvents:l,viewStartHour:F,viewEndHour:A,onEventDrop:G,onEventClick:q,hideHeader:t,today:r})})},e.toISOString())})})]})})};return(0,s.jsxs)("div",{className:"p-4 sm:p-6 flex flex-col h-full",children:[(0,s.jsxs)("header",{className:"text-center mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold font-headline text-primary",children:"Calendar"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Manage your schedule, events and appointments."})]}),(0,s.jsxs)("div",{className:"flex-1 min-h-0 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4 pb-4 border-b",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold font-headline",children:(0,s.jsx)("span",{children:L})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(M.z,{onClick:()=>{R(null),K(!0)},children:"+New Event"}),(0,s.jsx)("div",{className:"flex items-center gap-1 rounded-md bg-muted p-1",children:[{id:"day",label:"Day"},{id:"5days",label:"5 Days"},{id:"week",label:"Week"},{id:"month",label:"Month"}].map(e=>(0,s.jsx)(M.z,{variant:d===e.id?"secondary":"ghost",size:"sm",onClick:()=>c(e.id),className:"h-8 px-3",children:e.label},e.id))}),(0,s.jsxs)(M.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{e&&t("month"===d?(0,f.z)(e,-1):"week"===d?(0,p.j)(e,-1):"5days"===d?(0,h.E)(e,-5):(0,h.E)(e,-1))},children:[(0,s.jsx)("span",{className:"sr-only",children:"Previous period"}),(0,s.jsx)(g.Z,{className:"h-4 w-4"})]}),(0,s.jsxs)(M.z,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{e&&t("month"===d?(0,f.z)(e,1):"week"===d?(0,p.j)(e,1):"5days"===d?(0,h.E)(e,5):(0,h.E)(e,1))},children:[(0,s.jsx)("span",{className:"sr-only",children:"Next period"}),(0,s.jsx)(b.Z,{className:"h-4 w-4"})]})]})]}),(0,s.jsx)("div",{className:"flex-1 mt-4 overflow-hidden",children:(()=>{if(!e)return null;if(P)return(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)(v.Z,{className:"h-12 w-12 animate-spin text-primary"})});switch(d){case"day":return X([e]);case"5days":return X((0,m.D)({start:e,end:(0,h.E)(e,4)}));case"week":return X((0,m.D)({start:(0,o.z)(e,{weekStartsOn:1}),end:(0,u.v)(e,{weekStartsOn:1})}));case"month":return(0,s.jsx)(D,{date:e,events:j,onEventClick:q,today:r});default:return null}})()})]}),H&&(0,s.jsx)(W.e,{isOpen:H,onOpenChange:e=>{K(e),e||R(null)},onTaskCreate:B,onTaskUpdate:J,eventToEdit:I,contacts:z})]})}},80023:function(e,t,r){"use strict";r.d(t,{ScrollArea:function(){return i}});var s=r(57437),a=r(2265),l=r(26770),n=r(49354);let i=a.forwardRef((e,t)=>{let{className:r,children:a,...i}=e;return(0,s.jsxs)(l.fC,{ref:t,className:(0,n.cn)("relative overflow-hidden",r),...i,children:[(0,s.jsx)(l.l_,{className:"h-full w-full rounded-[inherit]",children:a}),(0,s.jsx)(d,{}),(0,s.jsx)(l.Ns,{})]})});i.displayName=l.fC.displayName;let d=a.forwardRef((e,t)=>{let{className:r,orientation:a="vertical",...i}=e;return(0,s.jsx)(l.gb,{ref:t,orientation:a,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...i,children:(0,s.jsx)(l.q4,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=l.gb.displayName}},function(e){e.O(0,[4358,4728,2641,7255,4086,5510,9279,3070,23,1792,1313,2827,1374,4694,3796,3865,2393,4088,2971,7023,1744],function(){return e(e.s=4109)}),_N_E=e.O()}]);